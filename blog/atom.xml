<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://napiworld.ru/blog</id>
    <title>NAPI - одноплатники и вычислительные модули Blog</title>
    <updated>2024-02-27T00:00:00.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://napiworld.ru/blog"/>
    <subtitle>NAPI - одноплатники и вычислительные модули Blog</subtitle>
    <icon>https://napiworld.ru/img/favicon.ico</icon>
    <entry>
        <title type="html"><![CDATA[DIY-плата на NAPI-C. Часть 1. Железо.]]></title>
        <id>https://napiworld.ru/blog/dmn-napi-diy</id>
        <link href="https://napiworld.ru/blog/dmn-napi-diy"/>
        <updated>2024-02-27T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Почему мы делаем плату на NAPI-C]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="почему-мы-делаем-плату-на-napi-c">Почему мы делаем плату на NAPI-C<a href="#почему-мы-делаем-плату-на-napi-c" class="hash-link" aria-label="Прямая ссылка на Почему мы делаем плату на NAPI-C" title="Прямая ссылка на Почему мы делаем плату на NAPI-C">​</a></h2><p>Когда мы задумали одноплатный компьютер Napi с штырьками c шагом 2.54мм, основная идея была в том, что на нем легко будет делать прототипы и проверять теории. Имея уже на борту сеть и USB, можно с ножек (GPIO) "забирать" интерфейсы и строить свои устройства. </p><p><img loading="lazy" src="/assets/images/napi-hands-a6bcb734caa014c2d6b277237eece1eb.jpg" width="508" height="253" class="img_ev3q"></p><p>Доказывать теорию будем живым примером демонстрационной платы, которая будет сделана на монтажной плате, несложной навесной пайкой. </p><p>Притом, имея опыт прототипирования для микроконтроллеров, некоторые интерфейсы сделаем взаимозаменяемыми, в формате популярных плат расширения для МK wemos d1 mini.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="интерфейсы-для-тестирования">Интерфейсы для тестирования<a href="#интерфейсы-для-тестирования" class="hash-link" aria-label="Прямая ссылка на Интерфейсы для тестирования" title="Прямая ссылка на Интерфейсы для тестирования">​</a></h2><p>Какие интерфейсы позволяет подключить NAPI ? </p><p><img loading="lazy" src="/assets/images/gpio_11123-4-242b2c2645de689a201c4ef706952383.jpg" width="690" height="655" class="img_ev3q"></p><ul><li>UART: Консоль вывода, RS485\RS232, Lora\Zigbee модемы</li><li>I2C: цифровые датчики, ЦАП-ы, часы реального времени</li><li>SPI: цифровые датчики, накопители, дисплеи, микроконтроллеры</li></ul><p>Через цифровые GPIO можно управлять реле, светодиодами, кнопками и другими "кастомными" устройствами.  </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="выберем-устройства-для-подключения">Выберем устройства для подключения<a href="#выберем-устройства-для-подключения" class="hash-link" aria-label="Прямая ссылка на Выберем устройства для подключения" title="Прямая ссылка на Выберем устройства для подключения">​</a></h2><ol><li><p>На <strong>UART0</strong> (<strong>GPIO2_A0, GPIO2_A1</strong>) у нас стандартная консоль Linux. Но мы можем сразу на плате установить преобразователь на USB-C для удобства работы. </p></li><li><p>На <strong>UART3</strong> (<strong>GPIO3_B5, GPIO3_B4</strong>) мы "подвесим" готовый модуль преобразования в RS485 порт для работы с дастчиками по протоколу modbus</p></li><li><p>На <strong>I2C3</strong> (<strong>GPIO0_C0 (SCL), GPI0_B7 (SDA)</strong>) мы присоединим цифровой датчик bmp280, который покажет нам температуру, давление, влажность. Но сделаем мы присоединение не напрямую а через сменяемую платку в формате расширений Wemos D1 mini. Это позволит нам менять такие модули и присоединять в будущем другие устройства i2c.</p></li><li><p>На <strong>SPI2</strong> (<strong>GPIO1_D0 (CLK), GPIO1_C6 (MISO), GPIO1_C7 (MOSI), GPIO1_D1 (CS)</strong>) мы "подвесим" готовый модуль термопары MAX6675K, которая опрашивается по интерфейсу SPI.</p></li><li><p>Для демонстрации работы модуля Реле, возьмем готовый модуль реле для Wemos D1, на который надо подать TTL 3.3 для механического замыкания контактов. Для этого используем <strong>GPIO2_B5</strong></p></li><li><p>Дальше для собственных фантазий можно вывести кроватки для произвольной платы расширения в формате ножек NAPI. Мы не стали слишком фантазировать и сделали платку расширения с 3-мя лампочками (<strong>GPIO2_B6, GPIO2_B7, GPIO2_C0</strong>) и кнопкой с фиксацией (<strong>GPIO2_B3</strong>).</p></li><li><p>Не забудем саму NAPI-C (не стали ее впаивать намертво, а поместили в кроватки, сделав вырез в монтажке под ETH\USB)</p></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="результат---на-картинках">Результат - на картинках<a href="#результат---на-картинках" class="hash-link" aria-label="Прямая ссылка на Результат - на картинках" title="Прямая ссылка на Результат - на картинках">​</a></h2><p>Вот так выглядит собранная плата (номера соответствуют пунктам из перечисления интерфейсов).</p><p><img loading="lazy" src="/assets/images/scheme-2-napi-diy-30fd49fb5891b768f2c3605b612a7d11.jpg" width="537" height="794" class="img_ev3q"></p><p>Довершила картинку платка внешнего питания с кнопкой вкл\выкл, кнопочка Reset (слева от RS485).</p><p>А так плата выглядит сбоку в сборе:</p><p><img loading="lazy" src="/assets/images/scheme-3-napi-diy-3817895af58583c9df3fee6ba17613fb.jpg" width="544" height="438" class="img_ev3q"></p><p>Для демонстрации сменяемости модулей вытащим датчик bmp280, снимем термопару, снимем платку расширения с лампочками. </p><p>Мы можем придумать другие датчики, платы расширения сохраняя распиновку GPIO!</p><p><img loading="lazy" src="/assets/images/scheme-4-napi-diy-ff0c9bdae52ab26e42e5fde6bc5afffc.jpg" width="554" height="462" class="img_ev3q"></p><p>А теперь откроем небольшой секрет: все элементы на плате можно "снять" и "одеть". Это мы сделали для того, чтобы, если мы будем делать следующую версию прототипа, перенести эти же элементы на другую версию платы (ведь всегда знаешь как надо сделать лучше, когда закончил).</p><p><img loading="lazy" src="/assets/images/scheme-5-napi-diy-81d4f9afb6da03302c37a73d000b98aa.jpg" width="498" height="408" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="обратная-сторона-луны">Обратная сторона луны<a href="#обратная-сторона-луны" class="hash-link" aria-label="Прямая ссылка на Обратная сторона луны" title="Прямая ссылка на Обратная сторона луны">​</a></h2><p>На обратной стороне конечно вся коммутация элементов. Выглядит жутковато, но
это не так все страшно, если соблюдать цвета и некоторые приемы при пайке.</p><p><img loading="lazy" src="/assets/images/scheme-6-napi-diy-40638809eb6ee62d87538f11a8aec08f.jpg" width="554" height="465" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="а-что-дальше">А что дальше<a href="#а-что-дальше" class="hash-link" aria-label="Прямая ссылка на А что дальше" title="Прямая ссылка на А что дальше">​</a></h2><p>Следующим шагом специалисты сделают принципиальную плату, а платы расширения с датчиками и другими идеями можно делать самим.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="а-софт-">А софт ?<a href="#а-софт-" class="hash-link" aria-label="Прямая ссылка на А софт ?" title="Прямая ссылка на А софт ?">​</a></h2><p>В следующей части мы покажем как управлять лампочками, щелкать реле, опрашивать датчики, ловить положение кнопки в ОС Linux. У нас уже все работает, но описание требует времени, а, значит, второй части статьи. </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="ссылки">Ссылки<a href="#ссылки" class="hash-link" aria-label="Прямая ссылка на Ссылки" title="Прямая ссылка на Ссылки">​</a></h2><ul><li>Одноплатный компьютер <a href="/docs/napi-intro">NAPI-C</a></li><li>BMP280: <a href="https://3d-diy.ru/wiki/arduino-datchiki/sensor-bmp280/" target="_blank" rel="noopener noreferrer">https://3d-diy.ru/wiki/arduino-datchiki/sensor-bmp280/</a> </li><li>MAX6675K: <a href="https://3d-diy.ru/product/normalizator-signala-termopary-k-tipa-max6675" target="_blank" rel="noopener noreferrer">https://3d-diy.ru/product/normalizator-signala-termopary-k-tipa-max6675</a></li><li>Relay shield: <a href="https://iarduino.ru/shop/Expansion-payments/wemos-relay-shield.html" target="_blank" rel="noopener noreferrer">https://iarduino.ru/shop/Expansion-payments/wemos-relay-shield.html</a></li><li>RS485: <a href="https://3d-diy.ru/wiki/arduino-moduli/interfeys-ttl-rs485/" target="_blank" rel="noopener noreferrer">https://3d-diy.ru/wiki/arduino-moduli/interfeys-ttl-rs485/</a></li><li>Power shield: <a href="https://aliexpress.ru/item/32960055175.html?sku_id=66493320637" target="_blank" rel="noopener noreferrer">https://aliexpress.ru/item/32960055175.html?sku_id=66493320637</a></li><li>UART-USB converter: <a href="https://voltiq.ru/shop/ch340e-usb-c-uart-converter/" target="_blank" rel="noopener noreferrer">https://voltiq.ru/shop/ch340e-usb-c-uart-converter/</a></li></ul>]]></content>
        <author>
            <name>dmn</name>
            <uri>https://github.com/dmnovikov</uri>
        </author>
        <category label="napiworld" term="napiworld"/>
        <category label="napi" term="napi"/>
        <category label="napi-c" term="napi-c"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[DIY-плата на NAPI-C. Часть 2. Софт.]]></title>
        <id>https://napiworld.ru/blog/dmn-napi-diy-soft</id>
        <link href="https://napiworld.ru/blog/dmn-napi-diy-soft"/>
        <updated>2024-02-26T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Плата из части 1]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="плата-из-части-1">Плата из части 1<a href="#плата-из-части-1" class="hash-link" aria-label="Прямая ссылка на Плата из части 1" title="Прямая ссылка на Плата из части 1">​</a></h2><p>В <a href="/blog/dmn-napi-diy">первой части</a> мы сделали плату с UART, I2C, SPI, GPIO</p><p><img loading="lazy" src="/assets/images/scheme-3-napi-diy-3817895af58583c9df3fee6ba17613fb.jpg" width="544" height="438" class="img_ev3q"></p><p>Теперь покажем как с ней работать в Linux</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="ставим-linux">Ставим Linux<a href="#ставим-linux" class="hash-link" aria-label="Прямая ссылка на Ставим Linux" title="Прямая ссылка на Ставим Linux">​</a></h2><p>Так как Napi это Linux компьютер, на него надо поставить Linux. Мы рекомендуем поставить наш вариант ARMbian, уже подготовленный для работы с NAPI и с предустановленным софтом. </p><p>Вы можете поставить чистый ARMbian, но необходимо доставить его "допилить" для использования с NAPI</p><ul><li><p><a href="/software/armbian-tune#%D1%81%D0%BA%D0%B0%D1%87%D0%B0%D0%B9%D1%82%D0%B5-%D0%BE%D0%B1%D1%80%D0%B0%D0%B7-%D0%BF%D0%BE-%D1%81%D1%81%D1%8B%D0%BB%D0%BA%D0%B5">Скачать и записать</a> на SD образ ARMbian</p></li><li><p><a href="/software/armbian-tune#%D0%BF%D1%80%D0%BE%D0%B2%D0%BE%D0%B4%D0%B8%D0%BC-%D1%82%D1%8E%D0%BD%D0%B8%D0%BD%D0%B3-armbian">Доставить нужные пакеты</a></p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="читаем-датчик-bmb280">Читаем датчик bmb280<a href="#читаем-датчик-bmb280" class="hash-link" aria-label="Прямая ссылка на Читаем датчик bmb280" title="Прямая ссылка на Читаем датчик bmb280">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="подключаем-оверлей-i2c3">Подключаем оверлей i2c3<a href="#подключаем-оверлей-i2c3" class="hash-link" aria-label="Прямая ссылка на Подключаем оверлей i2c3" title="Прямая ссылка на Подключаем оверлей i2c3">​</a></h3><p><strong>В Armbian</strong></p><ul><li>Сделайте файл с приведенным исходным кодом, имя файла <code>rk3308-i2c3-m0.dts</code></li></ul><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/dts-v1/;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/plugin/;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    compatible = "rockchip,rk3308";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fragment@0 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        target = &lt;&amp;pwm2&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        __overlay__ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            status = "disabled";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fragment@1 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        target = &lt;&amp;pwm3&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        __overlay__ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            status = "disabled";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fragment@2 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        target = &lt;&amp;i2c3&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        __overlay__ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            status = "okay";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            pinctrl-names = "default";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            pinctrl-0 = &lt;&amp;i2c3m0_xfer&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Выполните команду </li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  armbian-add-overlay rk3308-i2c3-m0.dts</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Перезагрузитесь, должно появиться устройство <code>/dev/i2c-3</code></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># ls /dev/i2c-3 </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/dev/i2c-3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>В NapiLinux</strong></p><ul><li>Откройте файл <code>/boot/uEnv.txt</code></li><li>Добавьте в раздел <code>overlays=</code> раздел <code>rk3308-i2c3-m0</code></li><li>Файл должен выглядеть примерно так</li></ul><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">verbosity=7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fdtfile=rk3308-rock-pi-s.dtb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">console=ttyS0,115200n8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">overlays=rk3308-uart3 rk3308-i2c3-m0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kernelimg=Image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">extraargs=</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Сохраните файл</li><li>Перезагрузитесь, должно появиться устройство <code>/dev/i2c-3</code></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="читаем-датчик-bmp280-библиотека-python">Читаем датчик bmp280 (библиотека python)<a href="#читаем-датчик-bmp280-библиотека-python" class="hash-link" aria-label="Прямая ссылка на Читаем датчик bmp280 (библиотека python)" title="Прямая ссылка на Читаем датчик bmp280 (библиотека python)">​</a></h3><p>Самый простой способ (но не единственный), подключить бибилотеку Python и запустить пример.</p><ol><li>Устанавливаем пакет python</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 -m pip </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> pimoroni-bme280</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>Cсылка на репозиторий: <a href="https://github.com/pimoroni/bme280-python" target="_blank" rel="noopener noreferrer">https://github.com/pimoroni/bme280-python</a></p></blockquote><ol start="2"><li>Создаем файл с примером, меняем строчку <code>bus = SMBus(1)</code> на <code>bus = SMBus(3)</code>, так как у нас i2c3.</li></ol><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">#!/usr/bin/env python</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> smbus2 </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> SMBus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> bme280 </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> BME280</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">"""all-values.py - Read temperature, pressure, and humidity</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">Press Ctrl+C to exit!</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">"""</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Initialise the BME280</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bus </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> SMBus</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bme280 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> BME280</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i2c_dev</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">bus</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    temperature </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> bme280</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_temperature</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pressure </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> bme280</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_pressure</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    humidity </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> bme280</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_humidity</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f"</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">temperature</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">:</span><span class="token string-interpolation interpolation format-spec">05.2f</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">°C </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">pressure</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">:</span><span class="token string-interpolation interpolation format-spec">05.2f</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">hPa </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">humidity</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">:</span><span class="token string-interpolation interpolation format-spec">05.2f</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">%"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>В этом листинге номер шины уже поменян.</p></blockquote><p>Назовем файл bmp280.py</p><ol start="3"><li>Запускаем скрипт и получаем параметры датчика</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># python3 bmp280.py </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">all-values.py - Read temperature, pressure, and humidity</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Press Ctrl+C to exit</span><span class="token operator" style="color:#393A34">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">24.16</span><span class="token plain">°C </span><span class="token number" style="color:#36acaa">646</span><span class="token plain">.16hPa </span><span class="token number" style="color:#36acaa">96.28</span><span class="token plain">%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">21.98</span><span class="token plain">°C </span><span class="token number" style="color:#36acaa">965</span><span class="token plain">.00hPa </span><span class="token number" style="color:#36acaa">24.86</span><span class="token plain">%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">21.99</span><span class="token plain">°C </span><span class="token number" style="color:#36acaa">965</span><span class="token plain">.00hPa </span><span class="token number" style="color:#36acaa">24.80</span><span class="token plain">%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">22.00</span><span class="token plain">°C </span><span class="token number" style="color:#36acaa">965</span><span class="token plain">.00hPa </span><span class="token number" style="color:#36acaa">24.76</span><span class="token plain">%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">22.00</span><span class="token plain">°C </span><span class="token number" style="color:#36acaa">965</span><span class="token plain">.00hPa </span><span class="token number" style="color:#36acaa">24.64</span><span class="token plain">%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">22.00</span><span class="token plain">°C </span><span class="token number" style="color:#36acaa">965</span><span class="token plain">.00hPa </span><span class="token number" style="color:#36acaa">24.58</span><span class="token plain">%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">^CTraceback </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">most recent call last</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  File </span><span class="token string" style="color:#e3116c">"/root/bmp280.py"</span><span class="token plain">, line </span><span class="token number" style="color:#36acaa">26</span><span class="token plain">, </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">module</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time.sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">KeyboardInterrupt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Ура ! У нас работает i2c и датчик bmp280.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="читаем-датчик-термопары-max6675">Читаем датчик термопары max6675<a href="#читаем-датчик-термопары-max6675" class="hash-link" aria-label="Прямая ссылка на Читаем датчик термопары max6675" title="Прямая ссылка на Читаем датчик термопары max6675">​</a></h2><p>Подключаем overlay для работы с spi2</p><p><strong>В Armbian</strong></p><ul><li>Сделайте файл rk3308-spi2-spidev.dts такого содержания:</li></ul><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/dts-v1/;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/plugin/;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    compatible = "rockchip,rk3308";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fragment@0 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        target = &lt;&amp;spi2&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        __overlay__ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            #address-cells = &lt;1&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            #size-cells = &lt;0&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            status = "okay";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            spidev@0 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                compatible = "rohm,dh2228fv";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                status = "okay";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                reg = &lt;0&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                spi-max-frequency = &lt;10000000&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> fragment@1 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    target = &lt;&amp;uart1&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    __overlay__ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      status = "disabled";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  fragment@2 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    target = &lt;&amp;uart2&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    __overlay__ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      status = "disabled";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Выполните команду </li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  armbian-add-overlay rk3308-spi2-spidev.dts</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Перезагрузитесь, должно появиться устройство <code>/dev/spidev2.0</code></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># ls /dev/spidev2.0 </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/dev/spidev2.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>В NapiLinux</strong></p><ul><li>Откройте файл <code>/boot/uEnv.txt</code></li><li>Добавьте в раздел <code>overlays=</code> раздел <code>rk3308-spi2-spidev</code></li><li>Файл должен выглядеть примерно так</li></ul><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">verbosity=7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fdtfile=rk3308-rock-pi-s.dtb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">console=ttyS0,115200n8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">overlays=rk3308-uart3 rk3308-i2c3-m0 rk3308-spi2-spidev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kernelimg=Image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">extraargs=</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Сохраните файл</li><li>Перезагрузитесь, должно появиться устройство <code>/dev/spidev2.0</code></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="читаем-датчик-термопары-max6675-библиотека-python">Читаем датчик термопары max6675 (библиотека python)<a href="#читаем-датчик-термопары-max6675-библиотека-python" class="hash-link" aria-label="Прямая ссылка на Читаем датчик термопары max6675 (библиотека python)" title="Прямая ссылка на Читаем датчик термопары max6675 (библиотека python)">​</a></h3><p>Самый простой способ (но не единственный), подключить библиотеку Python и запустить пример.</p><ol><li><p>Для Armbian, устанавливаем пакет <code>python3-dev</code></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">apt install python3-dev</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Устанавливаем пакет spidev для Python</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 -m pip </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> spidev</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Создаем файл из примера </p></li></ol><blockquote><p>Ссылка на репозиторий с примерами: <a href="https://github.com/w4r-10rd/max6675-rpi/tree/main" target="_blank" rel="noopener noreferrer">https://github.com/w4r-10rd/max6675-rpi/tree/main</a></p></blockquote><p>Сделаем файл такого содержимого, назовем <code>max6675.py</code></p><blockquote><p>⚠️ Обратите внимание на строчку <code>spi.open(2, 0)</code>, так как у нас SPI2 !</p></blockquote><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import spidev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spi = spidev.SpiDev()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spi.open(2, 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spi.max_speed_hz = 3900000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">try:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    while 1:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        t = spi.readbytes(2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        msb = format(t[0], '#010b')</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        lsb = format(t[1], '#010b')</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        r_temp = msb[2:] + lsb[2:]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        t_bytes = "0b" + r_temp[0:13]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        temp = int(t_bytes, base=2)*0.25</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        print("Temperature: {:.2f} ºC".format(temp))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        time.sleep(2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">except KeyboardInterrupt:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print("Publisher stopped by user.")</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li>Запускаем скрипт, читаем данные</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~# python3 max6675.py </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Temperature: 22.75 ºC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Temperature: 22.25 ºC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Temperature: 22.50 ºC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Temperature: 22.50 ºC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">^CPublisher stopped by user.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Ура ! У нас работает spi и датчик max6675.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="щелкаем-реле-">Щелкаем реле !<a href="#щелкаем-реле-" class="hash-link" aria-label="Прямая ссылка на Щелкаем реле !" title="Прямая ссылка на Щелкаем реле !">​</a></h2><p>Реле подключено к GPIO2_B5. Нам необходимо научиться программно менять статус "ножки" для управления реле. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="с-помощью-пакета-gpiod">С помощью пакета gpiod<a href="#с-помощью-пакета-gpiod" class="hash-link" aria-label="Прямая ссылка на С помощью пакета gpiod" title="Прямая ссылка на С помощью пакета gpiod">​</a></h3><p>В Linux есть пакет gpiod для работы с GPIO, мы будем применять его. Но (!!!) для корректного чтения GPIO нам понадобиться свежая версия. Для ARMbian мы написали <a href="/software/gpiod2">статью</a>, как установить свежую версию из исходников (так как в пакете довольно старая версия).</p><blockquote><p>Для демонстрации работы реле, можно не обновлять gpiod, мы приведем команды для старой версии.</p></blockquote><blockquote><p>GPIO2_B5 для gpiod это gpiochip2 номер B(8)+5=13</p></blockquote><p>Поэтому чтобы включить реле надо выполнить команду (подходит для всех версий gpiod). Для gpiod2 выйти по Control-C.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~# gpioset -c gpiochip2 13=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Реле должно радостно щелкнуть и замкнуть контакты !</p><p>Чтобы выключить реле, необходимо выполнить команду(подходит для всех версий gpiod). Для gpiod2 выйти по Control-C.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioset -c gpiochip2 13=0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>В версии gpiod 1.6.3 команда <code>gpioget</code> сбьрасывает состояние GPIO, именно поэтому мы перешли на версию 2.0+</p></blockquote><p>Для gpiod2 ver 2+ можно выполнить следующие команды:</p><p>Убедимся что версия gpiod подходит</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioget -v</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gpioget </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">libgpiod</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> v2.2-devel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Copyright </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">C</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2017</span><span class="token plain">-2023 Bartosz Golaszewski</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">License: GPL-2.0-or-later</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">This is </span><span class="token function" style="color:#d73a49">free</span><span class="token plain"> software: you are </span><span class="token function" style="color:#d73a49">free</span><span class="token plain"> to change and redistribute it.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">There is NO WARRANTY, to the extent permitted by law.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioset -t 0 -c gpiochip2 13=1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>И прочитать текущее состояние GPIO</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioget -a  -c gpiochip2 13</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">"13"</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">active</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="с-помощью-подсистемы-sysfs">С помощью подсистемы sysfs<a href="#с-помощью-подсистемы-sysfs" class="hash-link" aria-label="Прямая ссылка на С помощью подсистемы sysfs" title="Прямая ссылка на С помощью подсистемы sysfs">​</a></h3><p>Для этого способа не нужно какого либо софта, но логика работы несколько отличается</p><ol><li>Вычисляем номер ножки. </li></ol><blockquote><p>В системе sysfs это будет GPIO2 (2*32) + B (8) + 5 (5) = 64+8+5=77</p></blockquote><ol start="2"><li>Включаем ножку командой</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># echo 77 &gt; /sys/class/gpio/export</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>У вас появится каталог <code>/sys/class/gpio/gpio77</code></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># ls /sys/class/gpio/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">export</span><span class="token plain">  gpio77  gpiochip0  gpiochip128  gpiochip32  gpiochip64  gpiochip96  unexport</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li>Проверим  направление GPIO</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># cat /sys/class/gpio/gpio77/direction </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">out</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="4"><li>Щелкаем уже реле ! Проверяем статус реле...</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># echo 1 &gt;/sys/class/gpio/gpio77/value </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># cat /sys/class/gpio/gpio77/value </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="5"><li>Выключаем реле</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># echo 0 &gt;/sys/class/gpio/gpio77/value </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># cat /sys/class/gpio/gpio77/value </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="6"><li>Закончить работу с GPIO нужно командой</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~# echo 77 &gt; /sys/class/gpio/unexport</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Поздравляем, вы научились работать с GPIO и реле !</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="мигаем-лампочками">Мигаем лампочками<a href="#мигаем-лампочками" class="hash-link" aria-label="Прямая ссылка на Мигаем лампочками" title="Прямая ссылка на Мигаем лампочками">​</a></h2><p>У нас есть плата расширения с 3-мя лампочками (GPIO2_B6, GPIO2_B7, GPIO2_C0) и кнопкой (GPIO2_B3). </p><p>Так как мы уже умеем работать с GPIO, приведем примеры работы с лампочками. </p><p>Простое включение</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~# gpioset  -c gpiochip2 14=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~# gpioset  -c gpiochip2 15=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~# gpioset  -c gpiochip2 16=1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Простое выключение</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioset  -c gpiochip2 14=0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioset  -c gpiochip2 15=0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioset  -c gpiochip2 16=0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Для gpiod2 включение и чтение статуса</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioset  -t 0 -c gpiochip2 14=1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioset  -t 0 -c gpiochip2 15=1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioset  -t 0 -c gpiochip2 16=1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioget -a -c gpiochip2 14</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">"14"</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">active</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioget -a -c gpiochip2 15</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">"15"</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">active</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioget -a -c gpiochip2 16</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">"16"</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">active</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioset  -t 0 -c gpiochip2 14=0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioset  -t 0 -c gpiochip2 15=0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioset  -t 0 -c gpiochip2 16=0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioget -a -c gpiochip2 14</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">"14"</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">inactive</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioget -a -c gpiochip2 15</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">"15"</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">inactive</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioget -a -c gpiochip2 16</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">"16"</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">inactive</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Также мы можем задать не просто включение а период "мигания". Обратите внимание, что процессы gpioset остаются "висеть" в фоне, лампочки будут мигать каждая со своей частотой.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioset  -z -t 500ms -c gpiochip2 14=1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioset  -z -t 200ms -c gpiochip2 15=1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioset  -z -t 100ms -c gpiochip2 16=1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># ps ax | grep gpioset</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token number" style="color:#36acaa">2107</span><span class="token plain"> ?        Ss     </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:00 gpioset -z -t 500ms -c gpiochip2 </span><span class="token number" style="color:#36acaa">14</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token number" style="color:#36acaa">2109</span><span class="token plain"> ?        Ss     </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:00 gpioset -z -t 200ms -c gpiochip2 </span><span class="token number" style="color:#36acaa">15</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token number" style="color:#36acaa">2111</span><span class="token plain"> ?        Ss     </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:00 gpioset -z -t 100ms -c gpiochip2 </span><span class="token number" style="color:#36acaa">16</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token number" style="color:#36acaa">2113</span><span class="token plain"> pts/0    S+     </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:00 </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> gpioset</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Чтобы снова работать с GPIO, нужно "убить" процессы</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># kill -9 2107</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># kill -9 2109</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># kill -9 2111</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># ps ax | grep gpioset</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token number" style="color:#36acaa">2120</span><span class="token plain"> pts/0    S+     </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:00 </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> gpioset</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Поздравляем ! Вы умеете мигать лампочками.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="включим-ласпочки-через-sysfs">Включим ласпочки через sysfs<a href="#включим-ласпочки-через-sysfs" class="hash-link" aria-label="Прямая ссылка на Включим ласпочки через sysfs" title="Прямая ссылка на Включим ласпочки через sysfs">​</a></h3><p>Инициализация </p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">78</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/sys/class/gpio/export</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">79</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/sys/class/gpio/export</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/sys/class/gpio/export</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Подсветим светодиоды</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># echo 1 &gt;/sys/class/gpio/gpio78/value </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># echo 1 &gt;/sys/class/gpio/gpio79/value </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># echo 1 &gt;/sys/class/gpio/gpio80/valu</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Погасим светодиоды </p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># echo 0 &gt;/sys/class/gpio/gpio78/value </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># echo 0 &gt;/sys/class/gpio/gpio79/value </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># echo 0 &gt;/sys/class/gpio/gpio80/valu</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Закончим работать с GPIO через sysfs</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">78</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/sys/class/gpio/unexport</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">79</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/sys/class/gpio/unexport</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/sys/class/gpio/unexport</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Поздравляем, Вы научились работать с светодиодами. </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="читаем-входящий-gpio">Читаем входящий GPIO<a href="#читаем-входящий-gpio" class="hash-link" aria-label="Прямая ссылка на Читаем входящий GPIO" title="Прямая ссылка на Читаем входящий GPIO">​</a></h2><p>У нас есть фиксирующаяся кнопка (GPIO2_B3), положение которой нужно знать по уровню напряжения на GPIO (так называемый TTL). </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="читаем-через-gpiod-20">Читаем через gpiod 2.0<a href="#читаем-через-gpiod-20" class="hash-link" aria-label="Прямая ссылка на Читаем через gpiod 2.0" title="Прямая ссылка на Читаем через gpiod 2.0">​</a></h3><p>Итак, тут нам подойдет только gpiod 2.0+. Мы уже умеем читать GPIO2_B3 = gpiochip2 номер 11.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioget -a -c gpiochip2 11</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">"11"</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">inactive</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Нажмем кнопку (передвинем рычажок) и прочтем снова</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioget -a -c gpiochip2 11</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">"11"</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">active</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Итак мы умеем читать состояние кнопочки !</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="читаем-через-sysfs">Читаем через sysfs<a href="#читаем-через-sysfs" class="hash-link" aria-label="Прямая ссылка на Читаем через sysfs" title="Прямая ссылка на Читаем через sysfs">​</a></h3><p>Инициализируем GPIO2_B3 = 32х2 номер 11 = 75</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># echo 75 &gt;/sys/class/gpio/export </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># cat /sys/class/gpio/gpio75/direction </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Читаем состояние кнопки </p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># cat /sys/class/gpio/gpio75/value </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Переключаем кнопку и снова читаем состояние</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># cat /sys/class/gpio/gpio75/value </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Поздравляем, мы умеем читать состояние GPIO через sysfs</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="работа-с-консолью-и-rs485">Работа с консолью и RS485<a href="#работа-с-консолью-и-rs485" class="hash-link" aria-label="Прямая ссылка на Работа с консолью и RS485" title="Прямая ссылка на Работа с консолью и RS485">​</a></h2><p>Мы не будем подробно описывать работу с консолью (это довольно очевидно).</p><p>Напомним только параметры последовательного порта для консоли: </p><ul><li>Armbian: 1500000\8n1</li><li>NapiLinux: 115200\8n1</li></ul><p>Flow Control (Аппаратное управление потоком) должно быть отключено.</p><p>Как работать с портом RS485 и опрашивать датчик по Modbus RTU подробно описано в <a href="/software/sensors/modbus-rtu/">данной статье</a>.</p>]]></content>
        <author>
            <name>dmn</name>
            <uri>https://github.com/dmnovikov</uri>
        </author>
        <category label="napiworld" term="napiworld"/>
        <category label="napi" term="napi"/>
        <category label="napi-c" term="napi-c"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[NAPI подробные рендеринги]]></title>
        <id>https://napiworld.ru/blog/dmn-napipict-big</id>
        <link href="https://napiworld.ru/blog/dmn-napipict-big"/>
        <updated>2024-01-22T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[NAPI-C: подробные рендеринги]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="napi-c-подробные-рендеринги">NAPI-C: подробные рендеринги<a href="#napi-c-подробные-рендеринги" class="hash-link" aria-label="Прямая ссылка на NAPI-C: подробные рендеринги" title="Прямая ссылка на NAPI-C: подробные рендеринги">​</a></h2><p><img loading="lazy" src="/assets/images/NA PI v1.4-3cccd2a45668204c867dcc1df0c77230.png" width="1016" height="1180" class="img_ev3q"></p><p><img loading="lazy" src="/assets/images/NA PI v1.4(1)-7e036a7838595e7540d8c4048ed5ef46.png" width="1016" height="1180" class="img_ev3q"></p>]]></content>
        <author>
            <name>dmn</name>
            <uri>https://github.com/dmnovikov</uri>
        </author>
        <category label="napiworld" term="napiworld"/>
        <category label="napi" term="napi"/>
        <category label="napi-c" term="napi-c"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Варианты расположения пин-ов (pins) в модулях NAPI]]></title>
        <id>https://napiworld.ru/blog/dmn-napipict</id>
        <link href="https://napiworld.ru/blog/dmn-napipict"/>
        <updated>2024-01-21T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Варианты запайки PIN-колодок NAPI-C]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="варианты-запайки-pin-колодок-napi-c">Варианты запайки PIN-колодок NAPI-C<a href="#варианты-запайки-pin-колодок-napi-c" class="hash-link" aria-label="Прямая ссылка на Варианты запайки PIN-колодок NAPI-C" title="Прямая ссылка на Варианты запайки PIN-колодок NAPI-C">​</a></h2><h2 class="anchor anchorWithStickyNavbar_LWe7" id="пины-вниз">Пины вниз<a href="#пины-вниз" class="hash-link" aria-label="Прямая ссылка на Пины вниз" title="Прямая ссылка на Пины вниз">​</a></h2><p><img loading="lazy" alt="napi" src="/assets/images/NA PI v1.4(7)-ddeec5692cf15a216c2a3fd7f6983741.png" width="2878" height="1852" class="img_ev3q"></p><p><img loading="lazy" src="/assets/images/NA PI v1.4(8)-943ebfebb09cfb1249b9c5272b9b854f.png" width="2755" height="1773" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="пины-вверх">Пины вверх<a href="#пины-вверх" class="hash-link" aria-label="Прямая ссылка на Пины вверх" title="Прямая ссылка на Пины вверх">​</a></h2><p><img loading="lazy" src="/assets/images/NA PI v1.4(3)-d235e40b070a7d65865dff04dce594c6.png" width="3248" height="2090" class="img_ev3q"></p><p><img loading="lazy" src="/assets/images/NA PI v1.4(2)-50058f6ddec8322288f6b052e9a917c8.png" width="2589" height="1666" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="без-пинов">Без пинов<a href="#без-пинов" class="hash-link" aria-label="Прямая ссылка на Без пинов" title="Прямая ссылка на Без пинов">​</a></h2><p><img loading="lazy" src="/assets/images/NA PI v1.4(4)-36d681b31305aa57eb8c06942cdac114.png" width="3418" height="2199" class="img_ev3q">
<img loading="lazy" src="/assets/images/NA PI v1.4(5)-988275f2c8de542da76fbcf8cf6e8888.png" width="2932" height="1887" class="img_ev3q"></p>]]></content>
        <author>
            <name>dmn</name>
            <uri>https://github.com/dmnovikov</uri>
        </author>
        <category label="napiworld" term="napiworld"/>
        <category label="napi" term="napi"/>
        <category label="napi-c" term="napi-c"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Супер комактный сборщик - первый взгляд]]></title>
        <id>https://napiworld.ru/blog/dmn-newproduct1</id>
        <link href="https://napiworld.ru/blog/dmn-newproduct1"/>
        <updated>2023-09-15T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Мы разрабатываем супер компактный сборщик. В ряде случаев, нам не нужны модули связи (достаточно Ethernet), но необходимо иметь максимально компактное устройство.]]></summary>
        <content type="html"><![CDATA[<p>Мы разрабатываем супер компактный сборщик. В ряде случаев, нам не нужны модули связи (достаточно Ethernet), но необходимо иметь максимально компактное устройство.</p><p>Например, это может быть логгер (самописец) для сбора данных с устройств, преобразователь данных (modbus rtu - modbus tcp, snmp v2 - snmp v3) и другой полезный функционал.</p><p>Для этого мы сделали супер компактное устройство со следующими параметрами</p><ul><li>процессорный модуль NAPI С</li><li>Ethernet 100мбит</li><li>USB-A</li><li>изолированный RS485</li><li>питание 9-36</li><li>модулем RTC</li></ul><blockquote><p>Ширина устройства - 25мм (!)</p></blockquote><blockquote><p>Тип крепления - на DIN-рейку</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="рендеринг-супер-компактного-сборщика">Рендеринг супер-компактного сборщика<a href="#рендеринг-супер-компактного-сборщика" class="hash-link" aria-label="Прямая ссылка на Рендеринг супер-компактного сборщика" title="Прямая ссылка на Рендеринг супер-компактного сборщика">​</a></h2><p><img loading="lazy" src="/assets/images/render1-7ec7b25d0af40d6139055b9e36382297.jpg" width="600" height="338" class="img_ev3q"></p><p><img loading="lazy" src="/assets/images/render2-d8ea2450c0d8de3763f40dd223268212.jpg" width="600" height="309" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="pcb">PCB<a href="#pcb" class="hash-link" aria-label="Прямая ссылка на PCB" title="Прямая ссылка на PCB">​</a></h2><p>Платки уже приехали</p><p><img loading="lazy" src="/assets/images/plates1-97f2bf2029876388256bf719770d4712.jpg" width="600" height="632" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="рендеринг-в-корпусе">Рендеринг в корпусе<a href="#рендеринг-в-корпусе" class="hash-link" aria-label="Прямая ссылка на Рендеринг в корпусе" title="Прямая ссылка на Рендеринг в корпусе">​</a></h2><p>Рендеринг в корпусе (без крышки)</p><p><img loading="lazy" src="/assets/images/case1-3c86227421d9a5fe2dff07574faf9e8b.jpg" width="600" height="428" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="тестирование">Тестирование<a href="#тестирование" class="hash-link" aria-label="Прямая ссылка на Тестирование" title="Прямая ссылка на Тестирование">​</a></h2><p>Если Вас интересует тестирование данного изделия (плат), или неободима дополнительная информация, свяжитесь с нами</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Руководитель группы разработок (Product owner)</div><div class="admonitionContent_S0QG"><p><strong>Дмитрий Новиков</strong></p><blockquote><p>E-mail: <a href="mailto:dmn@nnz.ru" target="_blank" rel="noopener noreferrer">dmn@nnz.ru</a>;
Телеграм: @dmn240</p></blockquote></div></div>]]></content>
        <author>
            <name>dmn</name>
            <uri>https://github.com/dmnovikov</uri>
        </author>
        <category label="napiworld" term="napiworld"/>
        <category label="elemy" term="elemy"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Сборщик - логгер данных с устройств ELEMY]]></title>
        <id>https://napiworld.ru/blog/dmn-elemy</id>
        <link href="https://napiworld.ru/blog/dmn-elemy"/>
        <updated>2023-09-09T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Отличительной особенностью сборщика и всех его модификаций является возможность опроса любых modbus датчиков,  хранение в базе данных прямо на устройстве и выдача данных в удобной форме через интерфейс Grafana.]]></summary>
        <content type="html"><![CDATA[<p>Отличительной особенностью сборщика и всех его модификаций является возможность опроса любых modbus датчиков,  хранение в базе данных прямо на устройстве и выдача данных в удобной форме через интерфейс Grafana.</p><p><img loading="lazy" alt="Alt text" src="/assets/images/elemy2-c31e6b2d0600839ad4c3a946d8058b52.png" width="478" height="377" class="img_ev3q"></p><p>Одним из применений является режим работы в режиме "самописец" - когда мы собираем и "складываем" данные на сборщике. Это полезная функция для анализа работы приборов, поиска и предупреждения поломок.</p><p><img loading="lazy" alt="Alt text" src="/assets/images/frontcontrol1-5aa1cd292cfd3ea345aa60dac9253b8e.png" width="385" height="291" class="img_ev3q"></p><p>В рамках сотрудничества с компанией&nbsp;<a href="http://elemy.ru" target="_blank" rel="noopener noreferrer">Elemy</a>&nbsp;мы установили Сборщик для сбора статистики работы приборов управления питанием (PDU) для ИТ сферы. Так как все устройства передают свои состояния по протоколу modbus tcp, то интеграция Сборщика свелась к написанию конфигурационного файла telegraf (описание регистров) и настройки dashboards в Grafana.</p><p><img loading="lazy" alt="Alt text" src="/assets/images/napiconfig-139df87ebb7ee8e512c45ae0b7a4d3c5.png" width="873" height="353" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="устройства-для-логгера-самописца">Устройства для логгера (самописца)<a href="#устройства-для-логгера-самописца" class="hash-link" aria-label="Прямая ссылка на Устройства для логгера (самописца)" title="Прямая ссылка на Устройства для логгера (самописца)">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="ats-1204">ATS-1204<a href="#ats-1204" class="hash-link" aria-label="Прямая ссылка на ATS-1204" title="Прямая ссылка на ATS-1204">​</a></h3><p><img loading="lazy" alt="Alt text" src="/assets/images/1204-dev-a4a807f5343ea4bf5ab1275b83abf94c.png" width="602" height="173" class="img_ev3q"></p><p>Дашбоард ATS-1204</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>подсказка</div><div class="admonitionContent_S0QG"><p>Пользователь может сам менять вид Дашборды, а также выбирать произвольные временные отрезки для анализа.</p></div></div><p><img loading="lazy" alt="Alt text" src="/assets/images/1204-g-a05401dc58917ad108a8f9724e0bd0a8.png" width="806" height="499" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="ccu-1001">CCU-1001<a href="#ccu-1001" class="hash-link" aria-label="Прямая ссылка на CCU-1001" title="Прямая ссылка на CCU-1001">​</a></h3><p><img loading="lazy" alt="Alt text" src="/assets/images/ccu-1001-dev-9e0ae3ec4921889b97da07c01a9a312c.png" width="635" height="176" class="img_ev3q"></p><p>Дашборды для CCU-1001</p><p><img loading="lazy" alt="Alt text" src="/assets/images/ccu-1001-dev-1-985ba0c11e64c725e795fc6d085e9449.png" width="808" height="419" class="img_ev3q"></p><p><img loading="lazy" alt="Alt text" src="/assets/images/ccu-1001-g-f2bfeca04fe4c969ab16e8b52e82a306.png" width="812" height="437" class="img_ev3q"></p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>подсказка</div><div class="admonitionContent_S0QG"><p>Вам не обязательно хранить данные в облаке, сборщик может хранить данные на себе больше года.</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="ipdu-1502">iPDU-1502<a href="#ipdu-1502" class="hash-link" aria-label="Прямая ссылка на iPDU-1502" title="Прямая ссылка на iPDU-1502">​</a></h3><p><img loading="lazy" alt="Alt text" src="/assets/images/1502-dev-8f091171103b199de04ef1c0a53640f5.png" width="617" height="132" class="img_ev3q"></p><p>Дашборард iPDU-1502</p><p><img loading="lazy" alt="Alt text" src="/assets/images/1502-dev--1-51abf956c5093b751e54ed8a268e4d9e.png" width="861" height="496" class="img_ev3q"></p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>подсказка</div><div class="admonitionContent_S0QG"><p>В процессе подготовки опроса устройств нам не понадобилось работать в командной строке. Конфигурации регистров modbus для датчиков загружаются через NapiConfig, настройка dashboard настраивается через веб-инструменты Grafana.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="работа-в-grafana">Работа в Grafana<a href="#работа-в-grafana" class="hash-link" aria-label="Прямая ссылка на Работа в Grafana" title="Прямая ссылка на Работа в Grafana">​</a></h2><p>Пользователь может не только просматривать графики, но и
менять параметры, временные рамки, очередность графиков.</p><p><img loading="lazy" src="/assets/images/grf1-48045489d644d4978d729babc942191a.gif" width="1450" height="994" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="мобильный-интерфейс">Мобильный интерфейс<a href="#мобильный-интерфейс" class="hash-link" aria-label="Прямая ссылка на Мобильный интерфейс" title="Прямая ссылка на Мобильный интерфейс">​</a></h2><p>Интерфейс Grafana прекрасно оптимизирован под разрешения
смартфонов и обладает полноценным функционалом.</p><p><img loading="lazy" alt="Alt text" src="/assets/images/mobile1-d83319e77a4e7a3bc8241dda4d068696.png" width="443" height="376" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="сcылки">Сcылки<a href="#сcылки" class="hash-link" aria-label="Прямая ссылка на Сcылки" title="Прямая ссылка на Сcылки">​</a></h2><ul><li><a href="/docs/computers/frontcontrol-compact">Подробнее про Сборщик-компакт</a></li><li><a href="http://www.elemy.ru" target="_blank" rel="noopener noreferrer">Оборудование Elemy</a></li></ul>]]></content>
        <author>
            <name>dmn</name>
            <uri>https://github.com/dmnovikov</uri>
        </author>
        <category label="napiworld" term="napiworld"/>
        <category label="elemy" term="elemy"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Сайт почти готов... и немного планов]]></title>
        <id>https://napiworld.ru/blog/dmn-first-post</id>
        <link href="https://napiworld.ru/blog/dmn-first-post"/>
        <updated>2023-08-10T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Здесь будут новинки, обновления, примеры применений устройств на основе NAPI.]]></summary>
        <content type="html"><![CDATA[<div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>примечание</div><div class="admonitionContent_S0QG"><p>Здесь будут новинки, обновления, примеры применений устройств на основе NAPI.</p></div></div><p>Чтобы первый пост не был пустым, приоткроем завесу над тем, что нас ждет впереди:</p><ul><li><p>SOM NAPI без разьемов Ethernet и USB-A, они будут в виде колодки для свободной реализации на плате.</p></li><li><p>SOM NAPI в форм-факторе mPCI для встраивания в устройства</p></li><li><p>Супер компактный сборщик на NAPI (оптимизированный под DIN-рейку)</p></li><li><p>Сборщик с различными модулями связи (оптимизированный под DIN-рейку)</p></li><li><p>Более компактный Токо-Сборщик</p></li></ul><p>Заглядывайте =)</p>]]></content>
        <author>
            <name>dmn</name>
            <uri>https://github.com/dmnovikov</uri>
        </author>
        <category label="napiworld" term="napiworld"/>
        <category label="elemy" term="elemy"/>
    </entry>
</feed>