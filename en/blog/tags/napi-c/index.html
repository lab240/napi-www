<!doctype html>
<html lang="en-US" dir="ltr" class="blog-wrapper blog-tags-post-list-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">4 posts tagged with &quot;napi-c&quot; | NAPI - одноплатники и вычислительные модули</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://napiworld.ru/en/blog/tags/napi-c"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" property="og:title" content="4 posts tagged with &quot;napi-c&quot; | NAPI - одноплатники и вычислительные модули"><meta data-rh="true" name="docusaurus_tag" content="blog_tags_posts"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_tags_posts"><link data-rh="true" rel="icon" href="/en/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://napiworld.ru/en/blog/tags/napi-c"><link data-rh="true" rel="alternate" href="https://napiworld.ru/blog/tags/napi-c" hreflang="ru-RU"><link data-rh="true" rel="alternate" href="https://napiworld.ru/en/blog/tags/napi-c" hreflang="en-US"><link data-rh="true" rel="alternate" href="https://napiworld.ru/blog/tags/napi-c" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/en/blog/rss.xml" title="NAPI - одноплатники и вычислительные модули RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/en/blog/atom.xml" title="NAPI - одноплатники и вычислительные модули Atom Feed">






<link rel="preconnect" href="https://mc.yandex.ru">
<script>!function(e,t,a,c,n,r,i){e[n]=e[n]||function(){(e[n].a=e[n].a||[]).push(arguments)},e[n].l=1*new Date,r=t.createElement(a),i=t.getElementsByTagName(a)[0],r.async=1,r.src="https://mc.yandex.ru/metrika/tag.js",i.parentNode.insertBefore(r,i)}(window,document,"script",0,"ym"),ym(95068299,"init",{defer:!0,clickmap:!0,trackLinks:!0,accurateTrackBounce:!0,webvisor:!0,ecommerce:!1,trackHash:!1})</script>
<noscript>
                            <div><img src="https://mc.yandex.ru/watch/95068299" style="position:absolute; left:-9999px;" alt=""></div>
                        </noscript><link rel="stylesheet" href="/en/assets/css/styles.3ddb5583.css">
<link rel="preload" href="/en/assets/js/runtime~main.c44f2c97.js" as="script">
<link rel="preload" href="/en/assets/js/main.7d6b48ea.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(e){}return e}()||function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/en/"><div class="navbar__logo"><img src="/en/img/logo.png" alt="Napi Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/en/img/logo_dark.png" alt="Napi Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div></a><a class="navbar__item navbar__link" href="/en/docs/napi-intro">Каталог</a><a class="navbar__item navbar__link" href="/en/software">Инструкции</a><div class="navbar__item dropdown dropdown--hoverable"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/en/blog">NAPI-блог</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/en/blog/archive">Все посты</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/en/blog">Недавние посты</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/en/blog/tags">Посты по тегам</a></li></ul></div><a class="navbar__item navbar__link" href="/en/contacts">Где купить</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/blog/tags/napi-c" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ru-RU">Русский</a></li><li><a href="/en/blog/tags/napi-c" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en-US">English</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/en/blog/dmn-napi-diy">DIY-плата на NAPI-C. Часть 1. Железо.</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/en/blog/dmn-napi-diy-soft">DIY-плата на NAPI-C. Часть 2. Софт.</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/en/blog/dmn-napipict-big">NAPI подробные рендеринги</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/en/blog/dmn-napipict">Варианты расположения пин-ов (pins) в модулях NAPI</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/en/blog/dmn-newproduct1">Супер комактный сборщик - первый взгляд</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><header class="margin-bottom--xl"><h1>4 posts tagged with &quot;napi-c&quot;</h1><a href="/en/blog/tags">View All Tags</a></header><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/en/blog/dmn-napi-diy">DIY-плата на NAPI-C. Часть 1. Железо.</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-02-27T00:00:00.000Z" itemprop="datePublished">February 27, 2024</time> · <!-- -->3 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/dmnovikov" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/17533288?v=4" alt="dmn"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/dmnovikov" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">dmn</span></a></div><small class="avatar__subtitle" itemprop="description">maintainer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="почему-мы-делаем-плату-на-napi-c">Почему мы делаем плату на NAPI-C<a href="#почему-мы-делаем-плату-на-napi-c" class="hash-link" aria-label="Direct link to Почему мы делаем плату на NAPI-C" title="Direct link to Почему мы делаем плату на NAPI-C">​</a></h2><p>Когда мы задумали одноплатный компьютер Napi с штырьками c шагом 2.54мм, основная идея была в том, что на нем легко будет делать прототипы и проверять теории. Имея уже на борту сеть и USB, можно с ножек (GPIO) &quot;забирать&quot; интерфейсы и строить свои устройства. </p><p><img loading="lazy" src="/en/assets/images/napi-hands-95bc42573439071b14a8009146cb5901.jpg" width="508" height="253" class="img_ev3q"></p><p>Доказывать теорию будем живым примером демонстрационной платы, которая будет сделана на монтажной плате, несложной навесной пайкой. </p><p>Притом, имея опыт прототипирования для микроконтроллеров, некоторые интерфейсы сделаем взаимозаменяемыми, в формате популярных плат расширения для МK wemos d1 mini.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="интерфейсы-для-тестирования">Интерфейсы для тестирования<a href="#интерфейсы-для-тестирования" class="hash-link" aria-label="Direct link to Интерфейсы для тестирования" title="Direct link to Интерфейсы для тестирования">​</a></h2><p>Какие интерфейсы позволяет подключить NAPI ? </p><p><img loading="lazy" src="/en/assets/images/gpio_11123-4-242b2c2645de689a201c4ef706952383.jpg" width="690" height="655" class="img_ev3q"></p><ul><li>UART: Консоль вывода, RS485\RS232, Lora\Zigbee модемы</li><li>I2C: цифровые датчики, ЦАП-ы, часы реального времени</li><li>SPI: цифровые датчики, накопители, дисплеи, микроконтроллеры</li></ul><p>Через цифровые GPIO можно управлять реле, светодиодами, кнопками и другими &quot;кастомными&quot; устройствами.  </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="выберем-устройства-для-подключения">Выберем устройства для подключения<a href="#выберем-устройства-для-подключения" class="hash-link" aria-label="Direct link to Выберем устройства для подключения" title="Direct link to Выберем устройства для подключения">​</a></h2><ol><li><p>На <strong>UART0</strong> (<strong>GPIO2_A0, GPIO2_A1</strong>) у нас стандартная консоль Linux. Но мы можем сразу на плате установить преобразователь на USB-C для удобства работы. </p></li><li><p>На <strong>UART3</strong> (<strong>GPIO3_B5, GPIO3_B4</strong>) мы &quot;подвесим&quot; готовый модуль преобразования в RS485 порт для работы с дастчиками по протоколу modbus</p></li><li><p>На <strong>I2C3</strong> (<strong>GPIO0_C0 (SCL), GPI0_B7 (SDA)</strong>) мы присоединим цифровой датчик bmp280, который покажет нам температуру, давление, влажность. Но сделаем мы присоединение не напрямую а через сменяемую платку в формате расширений Wemos D1 mini. Это позволит нам менять такие модули и присоединять в будущем другие устройства i2c.</p></li><li><p>На <strong>SPI2</strong> (<strong>GPIO1_D0 (CLK), GPIO1_C6 (MISO), GPIO1_C7 (MOSI), GPIO1_D1 (CS)</strong>) мы &quot;подвесим&quot; готовый модуль термопары MAX6675K, которая опрашивается по интерфейсу SPI.</p></li><li><p>Для демонстрации работы модуля Реле, возьмем готовый модуль реле для Wemos D1, на который надо подать TTL 3.3 для механического замыкания контактов. Для этого используем <strong>GPIO2_B5</strong></p></li><li><p>Дальше для собственных фантазий можно вывести кроватки для произвольной платы расширения в формате ножек NAPI. Мы не стали слишком фантазировать и сделали платку расширения с 3-мя лампочками (<strong>GPIO2_B6, GPIO2_B7, GPIO2_C0</strong>) и кнопкой с фиксацией (<strong>GPIO2_B3</strong>).</p></li><li><p>Не забудем саму NAPI-C (не стали ее впаивать намертво, а поместили в кроватки, сделав вырез в монтажке под ETH\USB)</p></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="результат---на-картинках">Результат - на картинках<a href="#результат---на-картинках" class="hash-link" aria-label="Direct link to Результат - на картинках" title="Direct link to Результат - на картинках">​</a></h2><p>Вот так выглядит собранная плата (номера соответствуют пунктам из перечисления интерфейсов).</p><p><img loading="lazy" src="/en/assets/images/scheme-2-napi-diy-2104c95bd3b29d03787aaed5c1fa9037.jpg" width="537" height="794" class="img_ev3q"></p><p>Довершила картинку платка внешнего питания с кнопкой вкл\выкл, кнопочка Reset (слева от RS485).</p><p>А так плата выглядит сбоку в сборе:</p><p><img loading="lazy" src="/en/assets/images/scheme-3-napi-diy-5fc11c3ae3200ca8aea1c3a760f75318.jpg" width="544" height="438" class="img_ev3q"></p><p>Для демонстрации сменяемости модулей вытащим датчик bmp280, снимем термопару, снимем платку расширения с лампочками. </p><p>Мы можем придумать другие датчики, платы расширения сохраняя распиновку GPIO!</p><p><img loading="lazy" src="/en/assets/images/scheme-4-napi-diy-110c29559f973868e2723bce5bd294f3.jpg" width="554" height="462" class="img_ev3q"></p><p>А теперь откроем небольшой секрет: все элементы на плате можно &quot;снять&quot; и &quot;одеть&quot;. Это мы сделали для того, чтобы, если мы будем делать следующую версию прототипа, перенести эти же элементы на другую версию платы (ведь всегда знаешь как надо сделать лучше, когда закончил).</p><p><img loading="lazy" src="/en/assets/images/scheme-5-napi-diy-d63efbfcc02b3bd0166bdd3f2bad38de.jpg" width="498" height="408" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="обратная-сторона-луны">Обратная сторона луны<a href="#обратная-сторона-луны" class="hash-link" aria-label="Direct link to Обратная сторона луны" title="Direct link to Обратная сторона луны">​</a></h2><p>На обратной стороне конечно вся коммутация элементов. Выглядит жутковато, но
это не так все страшно, если соблюдать цвета и некоторые приемы при пайке.</p><p><img loading="lazy" src="/en/assets/images/scheme-6-napi-diy-c93d703b29033e53f50d360ba5c7fe42.jpg" width="554" height="465" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="а-что-дальше">А что дальше<a href="#а-что-дальше" class="hash-link" aria-label="Direct link to А что дальше" title="Direct link to А что дальше">​</a></h2><p>Следующим шагом специалисты сделают принципиальную плату, а платы расширения с датчиками и другими идеями можно делать самим.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="а-софт-">А софт ?<a href="#а-софт-" class="hash-link" aria-label="Direct link to А софт ?" title="Direct link to А софт ?">​</a></h2><p>В следующей части мы покажем как управлять лампочками, щелкать реле, опрашивать датчики, ловить положение кнопки в ОС Linux. У нас уже все работает, но описание требует времени, а, значит, второй части статьи. </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="ссылки">Ссылки<a href="#ссылки" class="hash-link" aria-label="Direct link to Ссылки" title="Direct link to Ссылки">​</a></h2><ul><li>Одноплатный компьютер <a href="/en/docs/napi-intro">NAPI-C</a></li><li>BMP280: <a href="https://3d-diy.ru/wiki/arduino-datchiki/sensor-bmp280/" target="_blank" rel="noopener noreferrer">https://3d-diy.ru/wiki/arduino-datchiki/sensor-bmp280/</a> </li><li>MAX6675K: <a href="https://3d-diy.ru/product/normalizator-signala-termopary-k-tipa-max6675" target="_blank" rel="noopener noreferrer">https://3d-diy.ru/product/normalizator-signala-termopary-k-tipa-max6675</a></li><li>Relay shield: <a href="https://iarduino.ru/shop/Expansion-payments/wemos-relay-shield.html" target="_blank" rel="noopener noreferrer">https://iarduino.ru/shop/Expansion-payments/wemos-relay-shield.html</a></li><li>RS485: <a href="https://3d-diy.ru/wiki/arduino-moduli/interfeys-ttl-rs485/" target="_blank" rel="noopener noreferrer">https://3d-diy.ru/wiki/arduino-moduli/interfeys-ttl-rs485/</a></li><li>Power shield: <a href="https://aliexpress.ru/item/32960055175.html?sku_id=66493320637" target="_blank" rel="noopener noreferrer">https://aliexpress.ru/item/32960055175.html?sku_id=66493320637</a></li><li>UART-USB converter: <a href="https://voltiq.ru/shop/ch340e-usb-c-uart-converter/" target="_blank" rel="noopener noreferrer">https://voltiq.ru/shop/ch340e-usb-c-uart-converter/</a></li></ul></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/en/blog/tags/napiworld">napiworld</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/en/blog/tags/napi">napi</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/en/blog/tags/napi-c">napi-c</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/en/blog/dmn-napi-diy-soft">DIY-плата на NAPI-C. Часть 2. Софт.</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-02-26T00:00:00.000Z" itemprop="datePublished">February 26, 2024</time> · <!-- -->9 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/dmnovikov" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/17533288?v=4" alt="dmn"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/dmnovikov" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">dmn</span></a></div><small class="avatar__subtitle" itemprop="description">maintainer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="плата-из-части-1">Плата из части 1<a href="#плата-из-части-1" class="hash-link" aria-label="Direct link to Плата из части 1" title="Direct link to Плата из части 1">​</a></h2><p>В <a href="/en/blog/dmn-napi-diy">первой части</a> мы сделали плату с UART, I2C, SPI, GPIO</p><p><img loading="lazy" src="/en/assets/images/scheme-3-napi-diy-5fc11c3ae3200ca8aea1c3a760f75318.jpg" width="544" height="438" class="img_ev3q"></p><p>Теперь покажем как с ней работать в Linux</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="ставим-linux">Ставим Linux<a href="#ставим-linux" class="hash-link" aria-label="Direct link to Ставим Linux" title="Direct link to Ставим Linux">​</a></h2><p>Так как Napi это Linux компьютер, на него надо поставить Linux. Мы рекомендуем поставить наш вариант ARMbian, уже подготовленный для работы с NAPI и с предустановленным софтом. </p><p>Вы можете поставить чистый ARMbian, но необходимо доставить его &quot;допилить&quot; для использования с NAPI</p><ul><li><p><a href="/en/software/armbian-tune#%D1%81%D0%BA%D0%B0%D1%87%D0%B0%D0%B9%D1%82%D0%B5-%D0%BE%D0%B1%D1%80%D0%B0%D0%B7-%D0%BF%D0%BE-%D1%81%D1%81%D1%8B%D0%BB%D0%BA%D0%B5">Скачать и записать</a> на SD образ ARMbian</p></li><li><p><a href="/en/software/armbian-tune#%D0%BF%D1%80%D0%BE%D0%B2%D0%BE%D0%B4%D0%B8%D0%BC-%D1%82%D1%8E%D0%BD%D0%B8%D0%BD%D0%B3-armbian">Доставить нужные пакеты</a></p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="читаем-датчик-bmb280">Читаем датчик bmb280<a href="#читаем-датчик-bmb280" class="hash-link" aria-label="Direct link to Читаем датчик bmb280" title="Direct link to Читаем датчик bmb280">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="подключаем-оверлей-i2c3">Подключаем оверлей i2c3<a href="#подключаем-оверлей-i2c3" class="hash-link" aria-label="Direct link to Подключаем оверлей i2c3" title="Direct link to Подключаем оверлей i2c3">​</a></h3><p><strong>В Armbian</strong></p><ul><li>Сделайте файл с приведенным исходным кодом, имя файла <code>rk3308-i2c3-m0.dts</code></li></ul><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/dts-v1/;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/plugin/;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    compatible = &quot;rockchip,rk3308&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fragment@0 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        target = &lt;&amp;pwm2&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        __overlay__ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            status = &quot;disabled&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fragment@1 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        target = &lt;&amp;pwm3&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        __overlay__ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            status = &quot;disabled&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fragment@2 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        target = &lt;&amp;i2c3&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        __overlay__ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            status = &quot;okay&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            pinctrl-names = &quot;default&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            pinctrl-0 = &lt;&amp;i2c3m0_xfer&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Выполните команду </li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  armbian-add-overlay rk3308-i2c3-m0.dts</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Перезагрузитесь, должно появиться устройство <code>/dev/i2c-3</code></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># ls /dev/i2c-3 </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/dev/i2c-3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>В NapiLinux</strong></p><ul><li>Откройте файл <code>/boot/uEnv.txt</code></li><li>Добавьте в раздел <code>overlays=</code> раздел <code>rk3308-i2c3-m0</code></li><li>Файл должен выглядеть примерно так</li></ul><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">verbosity=7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fdtfile=rk3308-rock-pi-s.dtb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">console=ttyS0,115200n8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">overlays=rk3308-uart3 rk3308-i2c3-m0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kernelimg=Image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">extraargs=</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Сохраните файл</li><li>Перезагрузитесь, должно появиться устройство <code>/dev/i2c-3</code></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="читаем-датчик-bmp280-библиотека-python">Читаем датчик bmp280 (библиотека python)<a href="#читаем-датчик-bmp280-библиотека-python" class="hash-link" aria-label="Direct link to Читаем датчик bmp280 (библиотека python)" title="Direct link to Читаем датчик bmp280 (библиотека python)">​</a></h3><p>Самый простой способ (но не единственный), подключить бибилотеку Python и запустить пример.</p><ol><li>Устанавливаем пакет python</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 -m pip </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> pimoroni-bme280</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>Cсылка на репозиторий: <a href="https://github.com/pimoroni/bme280-python" target="_blank" rel="noopener noreferrer">https://github.com/pimoroni/bme280-python</a></p></blockquote><ol start="2"><li>Создаем файл с примером, меняем строчку <code>bus = SMBus(1)</code> на <code>bus = SMBus(3)</code>, так как у нас i2c3.</li></ol><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">#!/usr/bin/env python</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> smbus2 </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> SMBus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> bme280 </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> BME280</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;all-values.py - Read temperature, pressure, and humidity</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">Press Ctrl+C to exit!</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Initialise the BME280</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bus </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> SMBus</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bme280 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> BME280</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i2c_dev</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">bus</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    temperature </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> bme280</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_temperature</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pressure </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> bme280</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_pressure</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    humidity </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> bme280</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_humidity</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">temperature</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">:</span><span class="token string-interpolation interpolation format-spec">05.2f</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">°C </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">pressure</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">:</span><span class="token string-interpolation interpolation format-spec">05.2f</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">hPa </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">humidity</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">:</span><span class="token string-interpolation interpolation format-spec">05.2f</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">%&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>В этом листинге номер шины уже поменян.</p></blockquote><p>Назовем файл bmp280.py</p><ol start="3"><li>Запускаем скрипт и получаем параметры датчика</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># python3 bmp280.py </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">all-values.py - Read temperature, pressure, and humidity</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Press Ctrl+C to exit</span><span class="token operator" style="color:#393A34">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">24.16</span><span class="token plain">°C </span><span class="token number" style="color:#36acaa">646</span><span class="token plain">.16hPa </span><span class="token number" style="color:#36acaa">96.28</span><span class="token plain">%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">21.98</span><span class="token plain">°C </span><span class="token number" style="color:#36acaa">965</span><span class="token plain">.00hPa </span><span class="token number" style="color:#36acaa">24.86</span><span class="token plain">%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">21.99</span><span class="token plain">°C </span><span class="token number" style="color:#36acaa">965</span><span class="token plain">.00hPa </span><span class="token number" style="color:#36acaa">24.80</span><span class="token plain">%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">22.00</span><span class="token plain">°C </span><span class="token number" style="color:#36acaa">965</span><span class="token plain">.00hPa </span><span class="token number" style="color:#36acaa">24.76</span><span class="token plain">%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">22.00</span><span class="token plain">°C </span><span class="token number" style="color:#36acaa">965</span><span class="token plain">.00hPa </span><span class="token number" style="color:#36acaa">24.64</span><span class="token plain">%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">22.00</span><span class="token plain">°C </span><span class="token number" style="color:#36acaa">965</span><span class="token plain">.00hPa </span><span class="token number" style="color:#36acaa">24.58</span><span class="token plain">%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">^CTraceback </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">most recent call last</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  File </span><span class="token string" style="color:#e3116c">&quot;/root/bmp280.py&quot;</span><span class="token plain">, line </span><span class="token number" style="color:#36acaa">26</span><span class="token plain">, </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">module</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time.sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">KeyboardInterrupt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Ура ! У нас работает i2c и датчик bmp280.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="читаем-датчик-термопары-max6675">Читаем датчик термопары max6675<a href="#читаем-датчик-термопары-max6675" class="hash-link" aria-label="Direct link to Читаем датчик термопары max6675" title="Direct link to Читаем датчик термопары max6675">​</a></h2><p>Подключаем overlay для работы с spi2</p><p><strong>В Armbian</strong></p><ul><li>Сделайте файл rk3308-spi2-spidev.dts такого содержания:</li></ul><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/dts-v1/;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/plugin/;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    compatible = &quot;rockchip,rk3308&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fragment@0 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        target = &lt;&amp;spi2&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        __overlay__ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            #address-cells = &lt;1&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            #size-cells = &lt;0&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            status = &quot;okay&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            spidev@0 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                compatible = &quot;rohm,dh2228fv&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                status = &quot;okay&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                reg = &lt;0&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                spi-max-frequency = &lt;10000000&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> fragment@1 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    target = &lt;&amp;uart1&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    __overlay__ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      status = &quot;disabled&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  fragment@2 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    target = &lt;&amp;uart2&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    __overlay__ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      status = &quot;disabled&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Выполните команду </li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  armbian-add-overlay rk3308-spi2-spidev.dts</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Перезагрузитесь, должно появиться устройство <code>/dev/spidev2.0</code></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># ls /dev/spidev2.0 </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/dev/spidev2.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>В NapiLinux</strong></p><ul><li>Откройте файл <code>/boot/uEnv.txt</code></li><li>Добавьте в раздел <code>overlays=</code> раздел <code>rk3308-spi2-spidev</code></li><li>Файл должен выглядеть примерно так</li></ul><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">verbosity=7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fdtfile=rk3308-rock-pi-s.dtb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">console=ttyS0,115200n8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">overlays=rk3308-uart3 rk3308-i2c3-m0 rk3308-spi2-spidev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kernelimg=Image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">extraargs=</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Сохраните файл</li><li>Перезагрузитесь, должно появиться устройство <code>/dev/spidev2.0</code></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="читаем-датчик-термопары-max6675-библиотека-python">Читаем датчик термопары max6675 (библиотека python)<a href="#читаем-датчик-термопары-max6675-библиотека-python" class="hash-link" aria-label="Direct link to Читаем датчик термопары max6675 (библиотека python)" title="Direct link to Читаем датчик термопары max6675 (библиотека python)">​</a></h3><p>Самый простой способ (но не единственный), подключить библиотеку Python и запустить пример.</p><ol><li><p>Для Armbian, устанавливаем пакет <code>python3-dev</code></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">apt install python3-dev</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Устанавливаем пакет spidev для Python</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 -m pip </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> spidev</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Создаем файл из примера </p></li></ol><blockquote><p>Ссылка на репозиторий с примерами: <a href="https://github.com/w4r-10rd/max6675-rpi/tree/main" target="_blank" rel="noopener noreferrer">https://github.com/w4r-10rd/max6675-rpi/tree/main</a></p></blockquote><p>Сделаем файл такого содержимого, назовем <code>max6675.py</code></p><blockquote><p>⚠️ Обратите внимание на строчку <code>spi.open(2, 0)</code>, так как у нас SPI2 !</p></blockquote><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import spidev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spi = spidev.SpiDev()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spi.open(2, 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spi.max_speed_hz = 3900000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">try:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    while 1:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        t = spi.readbytes(2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        msb = format(t[0], &#x27;#010b&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        lsb = format(t[1], &#x27;#010b&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        r_temp = msb[2:] + lsb[2:]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        t_bytes = &quot;0b&quot; + r_temp[0:13]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        temp = int(t_bytes, base=2)*0.25</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        print(&quot;Temperature: {:.2f} ºC&quot;.format(temp))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        time.sleep(2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">except KeyboardInterrupt:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(&quot;Publisher stopped by user.&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li>Запускаем скрипт, читаем данные</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~# python3 max6675.py </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Temperature: 22.75 ºC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Temperature: 22.25 ºC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Temperature: 22.50 ºC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Temperature: 22.50 ºC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">^CPublisher stopped by user.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Ура ! У нас работает spi и датчик max6675.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="щелкаем-реле-">Щелкаем реле !<a href="#щелкаем-реле-" class="hash-link" aria-label="Direct link to Щелкаем реле !" title="Direct link to Щелкаем реле !">​</a></h2><p>Реле подключено к GPIO2_B5. Нам необходимо научиться программно менять статус &quot;ножки&quot; для управления реле. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="с-помощью-пакета-gpiod">С помощью пакета gpiod<a href="#с-помощью-пакета-gpiod" class="hash-link" aria-label="Direct link to С помощью пакета gpiod" title="Direct link to С помощью пакета gpiod">​</a></h3><p>В Linux есть пакет gpiod для работы с GPIO, мы будем применять его. Но (!!!) для корректного чтения GPIO нам понадобиться свежая версия. Для ARMbian мы написали <a href="/en/software/gpiod2">статью</a>, как установить свежую версию из исходников (так как в пакете довольно старая версия).</p><blockquote><p>Для демонстрации работы реле, можно не обновлять gpiod, мы приведем команды для старой версии.</p></blockquote><blockquote><p>GPIO2_B5 для gpiod это gpiochip2 номер B(8)+5=13</p></blockquote><p>Поэтому чтобы включить реле надо выполнить команду (подходит для всех версий gpiod). Для gpiod2 выйти по Control-C.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~# gpioset -c gpiochip2 13=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Реле должно радостно щелкнуть и замкнуть контакты !</p><p>Чтобы выключить реле, необходимо выполнить команду(подходит для всех версий gpiod). Для gpiod2 выйти по Control-C.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioset -c gpiochip2 13=0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>В версии gpiod 1.6.3 команда <code>gpioget</code> сбьрасывает состояние GPIO, именно поэтому мы перешли на версию 2.0+</p></blockquote><p>Для gpiod2 ver 2+ можно выполнить следующие команды:</p><p>Убедимся что версия gpiod подходит</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioget -v</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gpioget </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">libgpiod</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> v2.2-devel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Copyright </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">C</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2017</span><span class="token plain">-2023 Bartosz Golaszewski</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">License: GPL-2.0-or-later</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">This is </span><span class="token function" style="color:#d73a49">free</span><span class="token plain"> software: you are </span><span class="token function" style="color:#d73a49">free</span><span class="token plain"> to change and redistribute it.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">There is NO WARRANTY, to the extent permitted by law.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioset -t 0 -c gpiochip2 13=1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>И прочитать текущее состояние GPIO</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioget -a  -c gpiochip2 13</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&quot;13&quot;</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">active</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="с-помощью-подсистемы-sysfs">С помощью подсистемы sysfs<a href="#с-помощью-подсистемы-sysfs" class="hash-link" aria-label="Direct link to С помощью подсистемы sysfs" title="Direct link to С помощью подсистемы sysfs">​</a></h3><p>Для этого способа не нужно какого либо софта, но логика работы несколько отличается</p><ol><li>Вычисляем номер ножки. </li></ol><blockquote><p>В системе sysfs это будет GPIO2 (2*32) + B (8) + 5 (5) = 64+8+5=77</p></blockquote><ol start="2"><li>Включаем ножку командой</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># echo 77 &gt; /sys/class/gpio/export</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>У вас появится каталог <code>/sys/class/gpio/gpio77</code></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># ls /sys/class/gpio/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">export</span><span class="token plain">  gpio77  gpiochip0  gpiochip128  gpiochip32  gpiochip64  gpiochip96  unexport</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li>Проверим  направление GPIO</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># cat /sys/class/gpio/gpio77/direction </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">out</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="4"><li>Щелкаем уже реле ! Проверяем статус реле...</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># echo 1 &gt;/sys/class/gpio/gpio77/value </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># cat /sys/class/gpio/gpio77/value </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="5"><li>Выключаем реле</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># echo 0 &gt;/sys/class/gpio/gpio77/value </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># cat /sys/class/gpio/gpio77/value </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="6"><li>Закончить работу с GPIO нужно командой</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~# echo 77 &gt; /sys/class/gpio/unexport</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Поздравляем, вы научились работать с GPIO и реле !</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="мигаем-лампочками">Мигаем лампочками<a href="#мигаем-лампочками" class="hash-link" aria-label="Direct link to Мигаем лампочками" title="Direct link to Мигаем лампочками">​</a></h2><p>У нас есть плата расширения с 3-мя лампочками (GPIO2_B6, GPIO2_B7, GPIO2_C0) и кнопкой (GPIO2_B3). </p><p>Так как мы уже умеем работать с GPIO, приведем примеры работы с лампочками. </p><p>Простое включение</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~# gpioset  -c gpiochip2 14=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~# gpioset  -c gpiochip2 15=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~# gpioset  -c gpiochip2 16=1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Простое выключение</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioset  -c gpiochip2 14=0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioset  -c gpiochip2 15=0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioset  -c gpiochip2 16=0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Для gpiod2 включение и чтение статуса</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioset  -t 0 -c gpiochip2 14=1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioset  -t 0 -c gpiochip2 15=1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioset  -t 0 -c gpiochip2 16=1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioget -a -c gpiochip2 14</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&quot;14&quot;</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">active</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioget -a -c gpiochip2 15</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&quot;15&quot;</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">active</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioget -a -c gpiochip2 16</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&quot;16&quot;</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">active</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioset  -t 0 -c gpiochip2 14=0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioset  -t 0 -c gpiochip2 15=0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioset  -t 0 -c gpiochip2 16=0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioget -a -c gpiochip2 14</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&quot;14&quot;</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">inactive</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioget -a -c gpiochip2 15</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&quot;15&quot;</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">inactive</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioget -a -c gpiochip2 16</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&quot;16&quot;</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">inactive</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Также мы можем задать не просто включение а период &quot;мигания&quot;. Обратите внимание, что процессы gpioset остаются &quot;висеть&quot; в фоне, лампочки будут мигать каждая со своей частотой.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioset  -z -t 500ms -c gpiochip2 14=1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioset  -z -t 200ms -c gpiochip2 15=1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioset  -z -t 100ms -c gpiochip2 16=1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># ps ax | grep gpioset</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token number" style="color:#36acaa">2107</span><span class="token plain"> ?        Ss     </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:00 gpioset -z -t 500ms -c gpiochip2 </span><span class="token number" style="color:#36acaa">14</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token number" style="color:#36acaa">2109</span><span class="token plain"> ?        Ss     </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:00 gpioset -z -t 200ms -c gpiochip2 </span><span class="token number" style="color:#36acaa">15</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token number" style="color:#36acaa">2111</span><span class="token plain"> ?        Ss     </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:00 gpioset -z -t 100ms -c gpiochip2 </span><span class="token number" style="color:#36acaa">16</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token number" style="color:#36acaa">2113</span><span class="token plain"> pts/0    S+     </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:00 </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> gpioset</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Чтобы снова работать с GPIO, нужно &quot;убить&quot; процессы</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># kill -9 2107</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># kill -9 2109</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># kill -9 2111</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># ps ax | grep gpioset</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token number" style="color:#36acaa">2120</span><span class="token plain"> pts/0    S+     </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:00 </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> gpioset</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Поздравляем ! Вы умеете мигать лампочками.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="включим-ласпочки-через-sysfs">Включим ласпочки через sysfs<a href="#включим-ласпочки-через-sysfs" class="hash-link" aria-label="Direct link to Включим ласпочки через sysfs" title="Direct link to Включим ласпочки через sysfs">​</a></h3><p>Инициализация </p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">78</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/sys/class/gpio/export</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">79</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/sys/class/gpio/export</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/sys/class/gpio/export</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Подсветим светодиоды</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># echo 1 &gt;/sys/class/gpio/gpio78/value </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># echo 1 &gt;/sys/class/gpio/gpio79/value </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># echo 1 &gt;/sys/class/gpio/gpio80/valu</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Погасим светодиоды </p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># echo 0 &gt;/sys/class/gpio/gpio78/value </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># echo 0 &gt;/sys/class/gpio/gpio79/value </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># echo 0 &gt;/sys/class/gpio/gpio80/valu</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Закончим работать с GPIO через sysfs</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">78</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/sys/class/gpio/unexport</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">79</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/sys/class/gpio/unexport</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/sys/class/gpio/unexport</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Поздравляем, Вы научились работать с светодиодами. </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="читаем-входящий-gpio">Читаем входящий GPIO<a href="#читаем-входящий-gpio" class="hash-link" aria-label="Direct link to Читаем входящий GPIO" title="Direct link to Читаем входящий GPIO">​</a></h2><p>У нас есть фиксирующаяся кнопка (GPIO2_B3), положение которой нужно знать по уровню напряжения на GPIO (так называемый TTL). </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="читаем-через-gpiod-20">Читаем через gpiod 2.0<a href="#читаем-через-gpiod-20" class="hash-link" aria-label="Direct link to Читаем через gpiod 2.0" title="Direct link to Читаем через gpiod 2.0">​</a></h3><p>Итак, тут нам подойдет только gpiod 2.0+. Мы уже умеем читать GPIO2_B3 = gpiochip2 номер 11.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioget -a -c gpiochip2 11</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&quot;11&quot;</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">inactive</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Нажмем кнопку (передвинем рычажок) и прочтем снова</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># gpioget -a -c gpiochip2 11</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&quot;11&quot;</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">active</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Итак мы умеем читать состояние кнопочки !</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="читаем-через-sysfs">Читаем через sysfs<a href="#читаем-через-sysfs" class="hash-link" aria-label="Direct link to Читаем через sysfs" title="Direct link to Читаем через sysfs">​</a></h3><p>Инициализируем GPIO2_B3 = 32х2 номер 11 = 75</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># echo 75 &gt;/sys/class/gpio/export </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># cat /sys/class/gpio/gpio75/direction </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Читаем состояние кнопки </p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># cat /sys/class/gpio/gpio75/value </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Переключаем кнопку и снова читаем состояние</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-armbian:~</span><span class="token comment" style="color:#999988;font-style:italic"># cat /sys/class/gpio/gpio75/value </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Поздравляем, мы умеем читать состояние GPIO через sysfs</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="работа-с-консолью-и-rs485">Работа с консолью и RS485<a href="#работа-с-консолью-и-rs485" class="hash-link" aria-label="Direct link to Работа с консолью и RS485" title="Direct link to Работа с консолью и RS485">​</a></h2><p>Мы не будем подробно описывать работу с консолью (это довольно очевидно).</p><p>Напомним только параметры последовательного порта для консоли: </p><ul><li>Armbian: 1500000\8n1</li><li>NapiLinux: 115200\8n1</li></ul><p>Flow Control (Аппаратное управление потоком) должно быть отключено.</p><p>Как работать с портом RS485 и опрашивать датчик по Modbus RTU подробно описано в <a href="/en/software/sensors/modbus-rtu/">данной статье</a>.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/en/blog/tags/napiworld">napiworld</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/en/blog/tags/napi">napi</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/en/blog/tags/napi-c">napi-c</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/en/blog/dmn-napipict-big">NAPI подробные рендеринги</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-01-22T00:00:00.000Z" itemprop="datePublished">January 22, 2024</time> · <!-- -->One min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/dmnovikov" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/17533288?v=4" alt="dmn"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/dmnovikov" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">dmn</span></a></div><small class="avatar__subtitle" itemprop="description">maintainer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="napi-c-подробные-рендеринги">NAPI-C: подробные рендеринги<a href="#napi-c-подробные-рендеринги" class="hash-link" aria-label="Direct link to NAPI-C: подробные рендеринги" title="Direct link to NAPI-C: подробные рендеринги">​</a></h2><p><img loading="lazy" src="/en/assets/images/NA PI v1.4-3bb6b74441ad30c9c069e0318563a1f0.png" width="1016" height="1180" class="img_ev3q"></p><p><img loading="lazy" src="/en/assets/images/NA PI v1.4(1)-d0665f699b94ef861cb21937155efbcd.png" width="1016" height="1180" class="img_ev3q"></p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/en/blog/tags/napiworld">napiworld</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/en/blog/tags/napi">napi</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/en/blog/tags/napi-c">napi-c</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/en/blog/dmn-napipict">Варианты расположения пин-ов (pins) в модулях NAPI</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-01-21T00:00:00.000Z" itemprop="datePublished">January 21, 2024</time> · <!-- -->One min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/dmnovikov" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/17533288?v=4" alt="dmn"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/dmnovikov" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">dmn</span></a></div><small class="avatar__subtitle" itemprop="description">maintainer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="варианты-запайки-pin-колодок-napi-c">Варианты запайки PIN-колодок NAPI-C<a href="#варианты-запайки-pin-колодок-napi-c" class="hash-link" aria-label="Direct link to Варианты запайки PIN-колодок NAPI-C" title="Direct link to Варианты запайки PIN-колодок NAPI-C">​</a></h2><h2 class="anchor anchorWithStickyNavbar_LWe7" id="пины-вниз">Пины вниз<a href="#пины-вниз" class="hash-link" aria-label="Direct link to Пины вниз" title="Direct link to Пины вниз">​</a></h2><p><img loading="lazy" alt="napi" src="/en/assets/images/NA PI v1.4(7)-6bb2f9abf64e39fe3594e3524078933e.png" width="2878" height="1852" class="img_ev3q"></p><p><img loading="lazy" src="/en/assets/images/NA PI v1.4(8)-8e202ae8a5873c42575e9b9eba1bdd68.png" width="2755" height="1773" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="пины-вверх">Пины вверх<a href="#пины-вверх" class="hash-link" aria-label="Direct link to Пины вверх" title="Direct link to Пины вверх">​</a></h2><p><img loading="lazy" src="/en/assets/images/NA PI v1.4(3)-72ef95b1368af83bc565e70b0b489171.png" width="3248" height="2090" class="img_ev3q"></p><p><img loading="lazy" src="/en/assets/images/NA PI v1.4(2)-b1c6e187e040e97d8f5971ad1e2d7172.png" width="2589" height="1666" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="без-пинов">Без пинов<a href="#без-пинов" class="hash-link" aria-label="Direct link to Без пинов" title="Direct link to Без пинов">​</a></h2><p><img loading="lazy" src="/en/assets/images/NA PI v1.4(4)-40368166d9c4b9766300e66e6892820d.png" width="3418" height="2199" class="img_ev3q">
<img loading="lazy" src="/en/assets/images/NA PI v1.4(5)-55a53c51270e727e61bd2807170443ad.png" width="2932" height="1887" class="img_ev3q"></p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/en/blog/tags/napiworld">napiworld</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/en/blog/tags/napi">napi</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/en/blog/tags/napi-c">napi-c</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Built with Docusaurus.</div></div></div></footer></div>
<script src="/en/assets/js/runtime~main.c44f2c97.js"></script>
<script src="/en/assets/js/main.7d6b48ea.js"></script>
</body>
</html>