<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://napiworld.ru/recipes</id>
    <title>Компактные компьютеры на Linux и Embedded устройства Blog</title>
    <updated>2026-02-11T00:00:00.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://napiworld.ru/recipes"/>
    <subtitle>Компактные компьютеры на Linux и Embedded устройства Blog</subtitle>
    <icon>https://napiworld.ru/img/favicon.ico</icon>
    <entry>
        <title type="html"><![CDATA[Подключение сетевых папок CIFS в Linux]]></title>
        <id>https://napiworld.ru/recipes/cifs-mount-linux</id>
        <link href="https://napiworld.ru/recipes/cifs-mount-linux"/>
        <updated>2026-02-11T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Подключаем сетевые папки (шары) в Linux из командной строки. Простые способы монтирования CIFS/SMB ресурсов.]]></summary>
        <content type="html"><![CDATA[<p>Подключаем сетевые папки (шары) в Linux из командной строки. Простые способы монтирования CIFS/SMB ресурсов.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="предварительные-условия">Предварительные условия<a class="hash-link" aria-label="Прямая ссылка на Предварительные условия" title="Прямая ссылка на Предварительные условия" href="https://napiworld.ru/recipes/cifs-mount-linux#%D0%BF%D1%80%D0%B5%D0%B4%D0%B2%D0%B0%D1%80%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D1%8B%D0%B5-%D1%83%D1%81%D0%BB%D0%BE%D0%B2%D0%B8%D1%8F">​</a></h2>
<p>Предполагаем, что:</p>
<ul>
<li>наш текущий пользователь в Linux - <code>dmn</code></li>
<li>сетевая папка называется <code>share</code></li>
<li>точка монтирования - <code>/home/dmn/dnld</code></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="подключение-без-пароля-гостевой-доступ">Подключение без пароля (гостевой доступ)<a class="hash-link" aria-label="Прямая ссылка на Подключение без пароля (гостевой доступ)" title="Прямая ссылк�а на Подключение без пароля (гостевой доступ)" href="https://napiworld.ru/recipes/cifs-mount-linux#%D0%BF%D0%BE%D0%B4%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D0%B5-%D0%B1%D0%B5%D0%B7-%D0%BF%D0%B0%D1%80%D0%BE%D0%BB%D1%8F-%D0%B3%D0%BE%D1%81%D1%82%D0%B5%D0%B2%D0%BE%D0%B9-%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF">​</a></h2>
<p>Для публичных папок или ресурсов с гостевым доступом:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo mount -t cifs //&lt;IP&gt;/share /home/dmn/dnld \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -o guest,uid=dmn,gid=dmn,iocharset=utf8</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="подключение-с-аутентификацией">Подключение с аутентификацией<a class="hash-link" aria-label="Прямая ссылка на Подключение с аутентификацией" title="Прямая ссылка на Подключение с аутентификацией" href="https://napiworld.ru/recipes/cifs-mount-linux#%D0%BF%D0%BE%D0%B4%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D0%B5-%D1%81-%D0%B0%D1%83%D1%82%D0%B5%D0%BD%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D0%B5%D0%B9">​</a></h2>
<p>Подключение с пользовательским логином и паролем:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo mount -t cifs //&lt;ip&gt;/share /home/dmn/dnld \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -o username=dmn,uid=dmn,gid=dmn,iocharset=utf8</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>При выполнении команды система запросит пароль пользователя.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="объяснение-параметров">Объяснение параметров<a class="hash-link" aria-label="Прямая ссылка на Объяснение параметров" title="Прямая ссылка на Объяснение параметров" href="https://napiworld.ru/recipes/cifs-mount-linux#%D0%BE%D0%B1%D1%8A%D1%8F%D1%81%D0%BD%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D0%B0%D1%80%D0%B0%D0%BC%D0%B5%D1%82%D1%80%D0%BE%D0%B2">​</a></h2>
<ul>
<li><strong>-t cifs</strong> - тип файловой системы</li>
<li><strong>guest</strong> - гостевой доступ без пароля</li>
<li><strong>username=dmn</strong> - имя пользователя для аутентификации</li>
<li><strong>uid=dmn,gid=dmn</strong> - назначение владельца файлов локальному пользователю</li>
<li><strong>iocharset=utf8</strong> - кодировка для корректного отображения русских имён файлов</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="отключение-сетевой-папки">Отключение сетевой папки<a class="hash-link" aria-label="Прямая ссылка на Отключение сетевой папки" title="Прямая ссылка на Отключение сетевой папки" href="https://napiworld.ru/recipes/cifs-mount-linux#%D0%BE%D1%82%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D0%B5-%D1%81%D0%B5%D1%82%D0%B5%D0%B2%D0%BE%D0%B9-%D0%BF%D0%B0%D0%BF%D0%BA%D0%B8">​</a></h2>
<p>Для размонтирования:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo umount /home/dmn/dnld</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="по�стоянное-подключение">Постоянное подключение<a class="hash-link" aria-label="Прямая ссылка на Постоянное подключение" title="Прямая ссылка на Постоянное подключение" href="https://napiworld.ru/recipes/cifs-mount-linux#%D0%BF%D0%BE%D1%81%D1%82%D0%BE%D1%8F%D0%BD%D0%BD%D0%BE%D0%B5-%D0%BF%D0%BE%D0%B4%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D0%B5">​</a></h2>
<p>Для автоматического монтирования при загрузке добавьте запись в <code>/etc/fstab</code>:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//&lt;IP&gt;/share /home/dmn/dnld cifs username=dmn,uid=dmn,gid=dmn,iocharset=utf8 0 0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Эти методы позволяют легко интегрировать сетевые ресурсы Windows/Samba в Linux окружение.</p>]]></content>
        <author>
            <name>dmn</name>
            <uri>https://github.com/dmnovikov</uri>
        </author>
        <category label="cifs" term="cifs"/>
        <category label="smb" term="smb"/>
        <category label="samba" term="samba"/>
        <category label="share" term="share"/>
        <category label="filesystem" term="filesystem"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Настройка и тестирование CAN интерфейса в Linux]]></title>
        <id>https://napiworld.ru/recipes/can-interface-setup</id>
        <link href="https://napiworld.ru/recipes/can-interface-setup"/>
        <updated>2026-02-04T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Настройка CAN интерфейса]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="настройка-can-интерфейса">Настройка CAN интерфейса<a class="hash-link" aria-label="Прямая ссылка на Настройка CAN интерфейса" title="Прямая ссылка на Настройка CAN интерфейса" href="https://napiworld.ru/recipes/can-interface-setup#%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0-can-%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D0%B0">​</a></h2>
<p>Поднимаем и проверяем CAN интерфейс.</p>
<p>Интересно, что CAN в Linux это сетевой интерфейс. На него нельзя повесить IP, но Linux управлять можно через ip link.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ip link set can0 down</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ip link set can0 type can bitrate 500000 restart-ms 100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ip link set can0 up</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="проверка-loopback">Проверка loopback<a class="hash-link" aria-label="Прямая ссылка на Проверка loopback" title="Прямая ссылка на Проверка loopback" href="https://napiworld.ru/recipes/can-interface-setup#%D0%BF%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D0%BA%D0%B0-loopback">​</a></h2>
<p>Проверяем loop (Аналог ping localhost).</p>
<p>Ставим пакет:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">apt install can-utils</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="тестирование">Тестирование<a class="hash-link" aria-label="Прямая ссылка на Тестирование" title="Прямая ссылка на Тестирование" href="https://napiworld.ru/recipes/can-interface-setup#%D1%82%D0%B5%D1%81%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5">​</a></h2>
<p>В одной сессии слушаем can0:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi2:~# candump -L can0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>В другой на этот же интерфейс шлем посылку:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cansend can0 123#11223344</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Должны получить ответ в сессии, где слушали:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(1769774861.028890) can0 123#11223344</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>#can #napi2</p>]]></content>
        <author>
            <name>dmn</name>
            <uri>https://github.com/dmnovikov</uri>
        </author>
        <category label="can" term="can"/>
        <category label="socketcan" term="socketcan"/>
        <category label="can-utils" term="can-utils"/>
        <category label="network" term="network"/>
        <category label="automotive" term="automotive"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Управление светодиодами Ethernet через MDIO]]></title>
        <id>https://napiworld.ru/recipes/ethernet-led-control</id>
        <link href="https://napiworld.ru/recipes/ethernet-led-control"/>
        <updated>2026-01-27T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Утилита для управления mdio (в частности, подсветкой лампочек Ethernet)//github.com/wkz/phytool]]></summary>
        <content type="html"><![CDATA[<p>Утилита для управления mdio (в частности, подсветкой лампочек Ethernet): <a href="https://github.com/wkz/phytool" target="_blank" rel="noopener noreferrer">https://github.com/wkz/phytool</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="классический-вид">Классический вид<a class="hash-link" aria-label="Прямая ссылка на Классический вид" title="Прямая ссылка на Классический вид" href="https://napiworld.ru/recipes/ethernet-led-control#%D0%BA%D0%BB%D0%B0%D1%81%D1%81%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9-%D0%B2%D0%B8%D0%B4">​</a></h2>
<p>Левый (зелёный) - линк, правый (рыжий) - данные:</p>
<ol>
<li>Выбрать страницу LED конфигурации:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./phytool write wan/0/0x1f 0x0d04</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>(Опционально) отключить EEE LED влияние:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./phytool write wan/0/0x11 0x0000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="3">
<li>Установить: LED1=Link(any speed), LED2=Activity:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./phytool write wan/0/0x10 0xC160</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="4">
<li>Вернуть страницу 0:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./phytool write wan/0/0x1f 0x0000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="альтернативный-вид">Альтернативный вид<a class="hash-link" aria-label="Прямая ссылка на Альтернативный вид" title="Прямая ссылка на Альтернативный вид" href="https://napiworld.ru/recipes/ethernet-led-control#%D0%B0%D0%BB%D1%8C%D1%82%D0%B5%D1%80%D0%BD%D0%B0%D1%82%D0%B8%D0%B2%D0%BD%D1%8B%D0%B9-%D0%B2%D0%B8%D0%B4">​</a></h2>
<p>Слева (зелёный) Link+Act (подмешивает в один диод и линк и моргание данными) 10mbit, справа (рыжий) - Link + Act 100+Mbit:</p>
<ol>
<li>Выбрать страницу LED конфигурации:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./phytool write wan/0/0x1f 0x0d04</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>(Опционально) отключить EEE LED влияние:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./phytool write wan/0/0x11 0x0000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="3">
<li>Установить: LED1=Link+Act 10mbit, LED2=Link+Act 100+Mbit:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./phytool write wan/0/0x10 0x6251</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="4">
<li>Вернуть страницу 0:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./phytool write wan/0/0x1f 0x0000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content>
        <author>
            <name>dmn</name>
            <uri>https://github.com/dmnovikov</uri>
        </author>
        <category label="ethernet" term="ethernet"/>
        <category label="mdio" term="mdio"/>
        <category label="led" term="led"/>
        <category label="phytool" term="phytool"/>
        <category label="network" term="network"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Получение уникального ID процессора Rockchip]]></title>
        <id>https://napiworld.ru/recipes/cpu-unique-id</id>
        <link href="https://napiworld.ru/recipes/cpu-unique-id"/>
        <updated>2026-01-17T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Получение уникального ID процессора]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="получение-уникального-id-процессора">Получение уникального ID процессора<a class="hash-link" aria-label="Прямая ссылка на Получение уникального ID процессора" title="Прямая ссылка на Получение уникального ID процессора" href="https://napiworld.ru/recipes/cpu-unique-id#%D0%BF%D0%BE%D0%BB%D1%83%D1%87%D0%B5%D0%BD%D0%B8%D0%B5-%D1%83%D0%BD%D0%B8%D0%BA%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B3%D0%BE-id-%D0%BF%D1%80%D0%BE%D1%86%D0%B5%D1%81%D1%81%D0%BE%D1%80%D0%B0">​</a></h2>
<p>Встал вопрос, как получить уникальный ID процессора для идентификации конкретного экземпляра <code>Napi-C/Napi-P/Napi-S</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="способ-через-otp">Способ через OTP<a class="hash-link" aria-label="Прямая ссылка на Способ через OTP" title="Прямая ссылка на Способ через OTP" href="https://napiworld.ru/recipes/cpu-unique-id#%D1%81%D0%BF%D0%BE%D1%81%D0%BE%D0%B1-%D1%87%D0%B5%D1%80%D0%B5%D0%B7-otp">​</a></h3>
<p>Мы нашли такой способ:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ID=$(dd if=/sys/bus/nvmem/devices/rockchip-otp0/nvmem bs=1 skip=8 count=8 2&gt;/dev/null | xxd -p)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo -n "$ID" | sha256sum</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="описание-команд">Описание команд<a class="hash-link" aria-label="Прямая ссылка на Описание команд" title="Прямая ссылка на Описание команд" href="https://napiworld.ru/recipes/cpu-unique-id#%D0%BE%D0%BF%D0%B8%D1%81%D0%B0%D0%BD%D0%B8%D0%B5-%D0%BA%D0%BE%D0%BC%D0%B0%D0%BD%D0%B4">​</a></h3>
<ul>
<li><code>dd</code> - читает 8 байт из OTP памяти процессора Rockchip начиная с 8-го байта</li>
<li><code>xxd -p</code> - конвертирует двоичные данные в hex строку</li>
<li><code>sha256sum</code> - создает SHA256 хеш для обеспечения уникальности</li>
</ul>]]></content>
        <author>
            <name>dmn</name>
            <uri>https://github.com/dmnovikov</uri>
        </author>
        <category label="cpu-id" term="cpu-id"/>
        <category label="rockchip" term="rockchip"/>
        <category label="otp" term="otp"/>
        <category label="unique-identifier" term="unique-identifier"/>
        <category label="security" term="security"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Анализ сигналов Modbus RS485 на анализаторе]]></title>
        <id>https://napiworld.ru/recipes/modbus-signal-analysis</id>
        <link href="https://napiworld.ru/recipes/modbus-signal-analysis"/>
        <updated>2026-01-17T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Анализ сигналов Modbus RS485]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="анализ-сигналов-modbus-rs485">Анализ сигналов Modbus RS485<a class="hash-link" aria-label="Прямая ссылка на Анализ сигналов Modbus RS485" title="Прямая ссылка на Анализ сигналов Modbus RS485" href="https://napiworld.ru/recipes/modbus-signal-analysis#%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7-%D1%81%D0%B8%D0%B3%D0%BD%D0%B0%D0%BB%D0%BE%D0%B2-modbus-rs485">​</a></h2>
<p>Покажем передачу modbus пакетов, отображенную на анализаторе цифровых сигналов.</p>
<p><img decoding="async" loading="lazy" src="https://napiworld.ru/assets/images/modbus-analyzer-9baf950a547c34476ebf02b3b7f1baa2.jpg" width="1280" height="452" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="оборудование">Оборудование<a class="hash-link" aria-label="Прямая ссылка на Оборудование" title="Прямая ссылка на Оборудование" href="https://napiworld.ru/recipes/modbus-signal-analysis#%D0%BE%D0%B1%D0%BE%D1%80%D1%83%D0%B4%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5">​</a></h3>
<ul>
<li><strong>Хост:</strong> Napi-C с программным RTS</li>
<li><strong>Датчик:</strong> учебный Modbus Napi-датчик</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="конфигурация-каналов">Конфигурация каналов<a class="hash-link" aria-label="Прямая ссылка на Конфигурация каналов" title="Прямая ссылка на Конфигурация каналов" href="https://napiworld.ru/recipes/modbus-signal-analysis#%D0%BA%D0%BE%D0%BD%D1%84%D0%B8%D0%B3%D1%83%D1%80%D0%B0%D1%86%D0%B8%D1%8F-%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%BE%D0%B2">​</a></h3>
<ul>
<li><strong>Канал 1:</strong> RTS хоста</li>
<li><strong>Канал 2:</strong> RX хоста</li>
<li><strong>Канал 3:</strong> TX хоста</li>
<li><strong>Канал 4:</strong> RX датчика</li>
<li><strong>Канал 5:</strong> TX датчика</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="последовательность-обмена">Последовательность обмена<a class="hash-link" aria-label="Прямая ссылка на Последовательность обмена" title="Прямая ссылка на Последовательность обмена" href="https://napiworld.ru/recipes/modbus-signal-analysis#%D0%BF%D0%BE%D1%81%D0%BB%D0%B5%D0%B4%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE%D1%81%D1%82%D1%8C-%D0%BE%D0%B1%D0%BC%D0%B5%D0%BD%D0%B0">​</a></h3>
<ol>
<li>Хост поднимает сигнал <strong>RTS</strong> (передача)</li>
<li>Посылает запрос по линии <strong>TX</strong></li>
<li>Датчик принимает запрос через <strong>RX</strong></li>
<li>Датчик передает ответ через <strong>TX</strong></li>
<li>Хост принимает ответ через <strong>RX</strong></li>
</ol>
<p>#rs485 #rts</p>]]></content>
        <author>
            <name>dmn</name>
            <uri>https://github.com/dmnovikov</uri>
        </author>
        <category label="modbus" term="modbus"/>
        <category label="rs485" term="rs485"/>
        <category label="signal-analysis" term="signal-analysis"/>
        <category label="rts" term="rts"/>
        <category label="logic-analyzer" term="logic-analyzer"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Настройка параметров последовательного порта в Linux]]></title>
        <id>https://napiworld.ru/recipes/serial-port-configuration</id>
        <link href="https://napiworld.ru/recipes/serial-port-configuration"/>
        <updated>2025-12-07T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Настройка последовательного порта]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="настройка-последовательного-порта">Настройка последовательного порта<a class="hash-link" aria-label="Прямая ссылка на Настройка последовательного порта" title="Прямая ссылка на Настройка последовательного порта" href="https://napiworld.ru/recipes/serial-port-configuration#%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0-%D0%BF%D0%BE%D1%81%D0%BB%D0%B5%D0%B4%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE%D0%B3%D0%BE-%D0%BF%D0%BE%D1%80%D1%82%D0%B0">​</a></h2>
<p>Установка параметров последовательного порта в Linux на примере <code>ttyS1</code></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="просмотр-текущих-параметров">Просмотр текущих параметров<a class="hash-link" aria-label="Прямая ссылка на Просмотр текущих параметров" title="Прямая ссылка на Просмотр текущих параметров" href="https://napiworld.ru/recipes/serial-port-configuration#%D0%BF%D1%80%D0%BE%D1%81%D0%BC%D0%BE%D1%82%D1%80-%D1%82%D0%B5%D0%BA%D1%83%D1%89%D0%B8%D1%85-%D0%BF%D0%B0%D1%80%D0%B0%D0%BC%D0%B5%D1%82%D1%80%D0%BE%D0%B2">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">stty -F /dev/ttyS1 -a</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Пример вывода:</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">speed 115200 baud; line = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-brkint -icrnl -imaxbel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">opost -onlcr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cs8 -parenb -cstopb</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="расшифровка-параметров">Расшифровка параметров<a class="hash-link" aria-label="Прямая ссылка на Расшифровка параметров" title="Прямая ссылка на Расшифровка параметров" href="https://napiworld.ru/recipes/serial-port-configuration#%D1%80%D0%B0%D1%81%D1%88%D0%B8%D1%84%D1%80%D0%BE%D0%B2%D0%BA%D0%B0-%D0%BF%D0%B0%D1%80%D0%B0%D0%BC%D0%B5%D1%82%D1%80%D0%BE%D0%B2">​</a></h3>
<ul>
<li><strong><code>speed 115200 baud</code></strong> — текущая скорость</li>
<li><strong><code>cs8</code></strong> — 8 бит данных</li>
<li><strong><code>-parenb</code></strong> — без бита четности (N)</li>
<li><strong><code>-cstopb</code></strong> — 1 стоп-бит (если было <code>cstopb</code> → 2 стоп-бита)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="установка-параметров-порта">Установка параметров порта<a class="hash-link" aria-label="Прямая ссылка на Установка параметров порта" title="Прямая ссылка на Установка параметров порта" href="https://napiworld.ru/recipes/serial-port-configuration#%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0-%D0%BF%D0%B0%D1%80%D0%B0%D0%BC%D0%B5%D1%82%D1%80%D0%BE%D0%B2-%D0%BF%D0%BE%D1%80%D1%82%D0%B0">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">stty -F /dev/ttyS1 115200 cs8 -cstopb -parenb -ixon -ixoff -crtscts</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="тестирование-порта">Тестирование порта<a class="hash-link" aria-label="Прямая ссылка на Тестирование порта" title="Прямая ссылка на Тестирование порта" href="https://napiworld.ru/recipes/serial-port-configuration#%D1%82%D0%B5%D1%81%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5-%D0%BF%D0%BE%D1%80%D1%82%D0%B0">​</a></h3>
<p>Дальше можно прямо из командной строки:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo "test" &gt; /dev/ttyS1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content>
        <author>
            <name>dmn</name>
            <uri>https://github.com/dmnovikov</uri>
        </author>
        <category label="uart" term="uart"/>
        <category label="serial" term="serial"/>
        <category label="stty" term="stty"/>
        <category label="linux" term="linux"/>
        <category label="configuration" term="configuration"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Диагностика занятости GPIO пинов в Linux]]></title>
        <id>https://napiworld.ru/recipes/gpio-pinmux-debug</id>
        <link href="https://napiworld.ru/recipes/gpio-pinmux-debug"/>
        <updated>2025-12-01T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Диагностика занятости GPIO]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="диагностика-занятости-gpio">Диагностика занятости GPIO<a class="hash-link" aria-label="Прямая ссылка на Диагностика занятости GPIO" title="Прямая ссылка на Диагностика занятости GPIO" href="https://napiworld.ru/recipes/gpio-pinmux-debug#%D0%B4%D0%B8%D0%B0%D0%B3%D0%BD%D0%BE%D1%81%D1%82%D0%B8%D0%BA%D0%B0-%D0%B7%D0%B0%D0%BD%D1%8F%D1%82%D0%BE%D1%81%D1%82%D0%B8-gpio">​</a></h2>
<p>В Linux можно посмотреть чем заняты все GPIO:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /sys/kernel/debug/pinctrl/pinctrl-rockchip-pinctrl/pinmux-pins</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="пример-вывода-на-napi-c">Пример вывода на NAPI-C<a class="hash-link" aria-label="Прямая ссылка на Пример вывода на NAPI-C" title="Прямая ссылка на Пример вывода на NAPI-C" href="https://napiworld.ru/recipes/gpio-pinmux-debug#%D0%BF%D1%80%D0%B8%D0%BC%D0%B5%D1%80-%D0%B2%D1%8B%D0%B2%D0%BE%D0%B4%D0%B0-%D0%BD%D0%B0-napi-c">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@rockpi-s:~# cat /sys/kernel/debug/pinctrl/pinctrl-rockchip-pinctrl/pinmux-pins</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Pinmux settings per pin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Format: pin (name): mux_owner gpio_owner hog?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pin 0 (gpio0-0): (MUX UNCLAIMED) (GPIO UNCLAIMED)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pin 1 (gpio0-1): (MUX UNCLAIMED) (GPIO UNCLAIMED)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pin 2 (gpio0-2): sdio-pwrseq gpio0:2 function sdio-pwrseq group wifi-enable-h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pin 3 (gpio0-3): ff480000.mmc (GPIO UNCLAIMED) function sdmmc group sdmmc-det</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pin 4 (gpio0-4): (MUX UNCLAIMED) (GPIO UNCLAIMED)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pin 5 (gpio0-5): leds gpio0:5 function leds group heartbeat-led</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pin 6 (gpio0-6): leds gpio0:6 function leds group green-led</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pin 7 (gpio0-7): stmmac-0:01 gpio0:7 function gmac group mac-rst</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pin 8 (gpio0-8): (MUX UNCLAIMED) (GPIO UNCLAIMED)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pin 9 (gpio0-9): (MUX UNCLAIMED) (GPIO UNCLAIMED)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pin 10 (gpio0-10): (MUX UNCLAIMED) (GPIO UNCLAIMED)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pin 11 (gpio0-11): ff050000.i2c (GPIO UNCLAIMED) function i2c1 group i2c1-xfer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pin 12 (gpio0-12): ff050000.i2c (GPIO UNCLAIMED) function i2c1 group i2c1-xfer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pin 13 (gpio0-13): ff180000.pwm (GPIO UNCLAIMED) function pwm0 group pwm0-pin-pull-down</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pin 14 (gpio0-14): (MUX UNCLAIMED) (GPIO UNCLAIMED)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pin 15 (gpio0-15): (MUX UNCLAIMED) (GPIO UNCLAIMED)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Ск�опировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="пример-занятого-gpio">Пример занятого GPIO<a class="hash-link" aria-label="Прямая ссылка на Пример занятого GPIO" title="Прямая ссылка на Пример занятого GPIO" href="https://napiworld.ru/recipes/gpio-pinmux-debug#%D0%BF%D1%80%D0%B8%D0%BC%D0%B5%D1%80-%D0%B7%D0%B0%D0%BD%D1%8F%D1%82%D0%BE%D0%B3%D0%BE-gpio">​</a></h3>
<p>Например, <code>GPIO0-A5</code> занят и мы не можем его использовать, например как DE для UART без лишних "процедур" по его освобождению:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@rockpi-s:~/S4-GPIO2_A5# cat /sys/kernel/debug/pinctrl/pinctrl-rockchip-pinctrl/pinmux-pins | grep gpio0-5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pin 5 (gpio0-5): leds gpio0:5 function leds group heartbeat-led</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@rockpi-s:~/S4-GPIO2_A5#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="пример-свободного-gpio">Пример свободного GPIO<a class="hash-link" aria-label="Прямая ссылка на Пример свободного GPIO" title="Прямая ссылка на Пример свободного GPIO" href="https://napiworld.ru/recipes/gpio-pinmux-debug#%D0%BF%D1%80%D0%B8%D0%BC%D0%B5%D1%80-%D1%81%D0%B2%D0%BE%D0%B1%D0%BE%D0%B4%D0%BD%D0%BE%D0%B3%D0%BE-gpio">​</a></h3>
<p>А вот <code>GPIO2-B4</code> выглядит как свободный:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@rockpi-s:~/S4-GPIO2_A5# cat /sys/kernel/debug/pinctrl/pinctrl-rockchip-pinctrl/pinmux-pins | grep gpio2-12</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pin 76 (gpio2-12): (MUX UNCLAIMED) (GPIO UNCLAIMED)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>И мы можем его программно "дергать":</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@rockpi-s:~/S4-GPIO2_A5# gpioset gpiochip2 12=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@rockpi-s:~/S4-GPIO2_A5# gpioset gpiochip2 12=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@rockpi-s:~/S4-GPIO2_A5#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="использование-gpio-в-dts">Использование GPIO в DTS<a class="hash-link" aria-label="Прямая ссылка на Использование GPIO в DTS" title="Прямая ссылка на Использование GPIO в DTS" href="https://napiworld.ru/recipes/gpio-pinmux-debug#%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5-gpio-%D0%B2-dts">​</a></h3>
<p>А теперь "захватим" пин <code>GPIO2_A5</code> для DE в UART1 таким DTS:</p>
<div class="language-dts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-dts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> /dts-v1/;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/plugin/;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  compatible = "rockchip,rk3308";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  fragment@0 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    target = &lt;&amp;uart1&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    __overlay__ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      status = "okay";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      pinctrl-names = "default";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      pinctrl-0 = &lt;&amp;uart1_xfer&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      linux,rs485-enabled-at-boot-time;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      rs485-rts-active-high;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      rs485-rts-delay = &lt;0 0&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      rts-gpios = &lt;&amp;gpio2 5 0&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="проверка-захвата-gpio">Проверка захвата GPIO<a class="hash-link" aria-label="Прямая ссылка на Проверка захвата GPIO" title="Прямая ссылка на Проверка захвата GPIO" href="https://napiworld.ru/recipes/gpio-pinmux-debug#%D0%BF%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D0%BA%D0%B0-%D0%B7%D0%B0%D1%85%D0%B2%D0%B0%D1%82%D0%B0-gpio">​</a></h3>
<p>Посмотрим как выглядит пин:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@rockpi-s:~/S4-GPIO2_A5# cat /sys/kernel/debug/pinctrl/pinctrl-rockchip-pinctrl/pinmux-pins | grep gpio2-5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pin 69 (gpio2-5): (MUX UNCLAIMED) gpio2:69</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@rockpi-s:~/S4-GPIO2_A5#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Тут не слишком понятно захватился он драйвером RS485 или нет. Но что важно, Linux не даст больше им "мигать", если он занят драйвером ядра:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@rockpi-s:~/S4-GPIO2_A5# gpioset gpiochip2 5=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gpioset: error setting the GPIO line values: Device or resource busy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@rockpi-s:~/S4-GPIO2_A5# gpioset gpiochip2 5=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gpioset: error setting the GPIO line values: Device or resource busy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@rockpi-s:~/S4-GPIO2_A5#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="тестирование-uart1">Тестирование UART1<a class="hash-link" aria-label="Прямая ссылка на Тестирование UART1" title="Прямая ссылка на Тестирование UART1" href="https://napiworld.ru/recipes/gpio-pinmux-debug#%D1%82%D0%B5%D1%81%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5-uart1">​</a></h3>
<p>Осталось убедиться, что мы получаем данные через UART1:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@rockpi-s:~/S4-GPIO2_A5# mbpoll -m rtu -P none -b 115200 -a 125 -r 1 -c 4 -t4   /dev/ttyS1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mbpoll 1.0-0 - FieldTalk(tm) Modbus(R) Master Simulator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Copyright © 2015-2019 Pascal JEAN, https://github.com/epsilonrt/mbpoll</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">This program comes with ABSOLUTELY NO WARRANTY.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">This is free software, and you are welcome to redistribute it</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">under certain conditions; type 'mbpoll -w' for details.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Protocol configuration: Modbus RTU</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Slave configuration...: address = [125]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        start reference = 1, count = 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Communication.........: /dev/ttyS1,     115200-8N1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        t/o 1.00 s, poll rate 1000 ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Data type.............: 16-bit register, output (holding) register table</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-- Polling slave 125... Ctrl-C to stop)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[1]:   125</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[2]:   1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[3]:   851</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[4]:   772</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content>
        <author>
            <name>dmn</name>
            <uri>https://github.com/dmnovikov</uri>
        </author>
        <category label="gpio" term="gpio"/>
        <category label="pinmux" term="pinmux"/>
        <category label="debug" term="debug"/>
        <category label="rockchip" term="rockchip"/>
        <category label="pinctrl" term="pinctrl"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Overlay для RS485 на UART1 с GPIO управлением направления]]></title>
        <id>https://napiworld.ru/recipes/rs485-uart1-overlay</id>
        <link href="https://napiworld.ru/recipes/rs485-uart1-overlay"/>
        <updated>2025-11-29T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Оверлей для RS485 на UART1]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="оверлей-для-rs485-на-uart1">Оверлей для RS485 на UART1<a class="hash-link" aria-label="Прямая ссылка на Оверлей для RS485 на UART1" title="Прямая ссылка на Оверлей для RS485 на UART1" href="https://napiworld.ru/recipes/rs485-uart1-overlay#%D0%BE%D0%B2%D0%B5%D1%80%D0%BB%D0%B5%D0%B9-%D0%B4%D0%BB%D1%8F-rs485-%D0%BD%D0%B0-uart1">​</a></h2>
<p>Оверлей для RS485 на UART1 (Napi-C) c контролем направления через GPIO (DE=GPIO2_B4)</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="конфигурация-dts">Конфигурация DTS<a class="hash-link" aria-label="Прямая ссылка на Конфигурация DTS" title="Прямая ссылка на Конфигурация DTS" href="https://napiworld.ru/recipes/rs485-uart1-overlay#%D0%BA%D0%BE%D0%BD%D1%84%D0%B8%D0%B3%D1%83%D1%80%D0%B0%D1%86%D0%B8%D1%8F-dts">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@rockpi-s:~/S3# cat uart1-de.dts</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-dts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-dts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/dts-v1/;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/plugin/;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  compatible = "rockchip,rk3308";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  fragment@0 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    target = &lt;&amp;uart1&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    __overlay__ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      status = "okay";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      pinctrl-names = "default";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      pinctrl-0 = &lt;&amp;uart1_xfer&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      linux,rs485-enabled-at-boot-time;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      rs485-rts-active-high;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      rs485-rts-delay = &lt;0 0&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      rts-gpios = &lt;&amp;gpio2 12 0&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>#rs485 #napic</p>]]></content>
        <author>
            <name>dmn</name>
            <uri>https://github.com/dmnovikov</uri>
        </author>
        <category label="rs485" term="rs485"/>
        <category label="uart" term="uart"/>
        <category label="overlay" term="overlay"/>
        <category label="gpio" term="gpio"/>
        <category label="napi-c" term="napi-c"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Получение текущего DTS из загруженной системы]]></title>
        <id>https://napiworld.ru/recipes/extract-running-dts</id>
        <link href="https://napiworld.ru/recipes/extract-running-dts"/>
        <updated>2025-11-23T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Получить текущий dts из dtb, с которой загрузилась система:]]></summary>
        <content type="html"><![CDATA[<p>Получить текущий dts из dtb, с которой загрузилась система:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dtc -I fs -O dts /sys/firmware/devicetree/base &gt; /tmp/running.dts</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Это ключевой файл, отображающий как система "понимает" всю перефирию и интерфейсы.</p>
<p>Внимательно изучайте файл <code>running.dts</code> через текстовый редактор - он ключ к пониманию как система интерпретирует интерфейсы.</p>
<p>И, кстати, этот dts можно "скормить" в ChatGPT и задавать вопросы или сформировать просьбу сделать overlay.</p>
<p>#kernel #dts</p>]]></content>
        <author>
            <name>dmn</name>
            <uri>https://github.com/dmnovikov</uri>
        </author>
        <category label="dts" term="dts"/>
        <category label="dtb" term="dtb"/>
        <category label="kernel" term="kernel"/>
        <category label="devicetree" term="devicetree"/>
        <category label="overlay" term="overlay"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Программное включение аппаратного reset в eMMC]]></title>
        <id>https://napiworld.ru/recipes/emmc-hardware-reset</id>
        <link href="https://napiworld.ru/recipes/emmc-hardware-reset"/>
        <updated>2025-10-23T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Продолжаем исследовать удивительный мир EMMC/SD]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="продолжаем-исследовать-удивительный-мир-emmcsd">Продолжаем исследовать удивительный мир EMMC/SD<a class="hash-link" aria-label="Прямая ссылка на Продолжаем исследовать удивительный мир EMMC/SD" title="Прямая ссылка на Продолжаем исследовать удивительный мир EMMC/SD" href="https://napiworld.ru/recipes/emmc-hardware-reset#%D0%BF%D1%80%D0%BE%D0%B4%D0%BE%D0%BB%D0%B6%D0%B0%D0%B5%D0%BC-%D0%B8%D1%81%D1%81%D0%BB%D0%B5%D0%B4%D0%BE%D0%B2%D0%B0%D1%82%D1%8C-%D1%83%D0%B4%D0%B8%D0%B2%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9-%D0%BC%D0%B8%D1%80-emmcsd">​</a></h2>
<p>Столкнулись с удивительной ситуацией на Napi Slot - при нажатии кнопки MaskRom. Эта кнопка переводит процессор в режим прошивки (на самом деле кнопка подтягивает <code>MMC_RESET</code> к <code>GND</code> и отключает EMMC, чтобы процессор не нашел с чего грузить систему и вошёл в режим прошивки).</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="проблема">Проблема<a class="hash-link" aria-label="Прямая ссылка на Проблема" title="Прямая ссылка на Проблема" href="https://napiworld.ru/recipes/emmc-hardware-reset#%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC%D0%B0">​</a></h2>
<p>Так вот процессор никак не реагировал!</p>
<p>Выяснилось, что в некоторых EMMC аппаратный reset включается <strong>ПРОГРАММНО</strong>!</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="рецепт-команд-linux">Рецепт команд Linux<a class="hash-link" aria-label="Прямая ссылка на Рецепт команд Linux" title="Прямая ссылка на Рецепт команд Linux" href="https://napiworld.ru/recipes/emmc-hardware-reset#%D1%80%D0%B5%D1%86%D0%B5%D0%BF%D1%82-%D0%BA%D0%BE%D0%BC%D0%B0%D0%BD%D0%B4-linux">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="считать-текущий-статус">Считать текущий статус<a class="hash-link" aria-label="Прямая ссылка на Считать текущий статус" title="Прямая ссылка на Считать текущий статус" href="https://napiworld.ru/recipes/emmc-hardware-reset#%D1%81%D1%87%D0%B8%D1%82%D0%B0%D1%82%D1%8C-%D1%82%D0%B5%D0%BA%D1%83%D1%89%D0%B8%D0%B9-%D1%81%D1%82%D0%B0%D1%82%D1%83%D1%81">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo mmc extcsd read /dev/mmcblk0 | grep -i RST_N_FUNCTION</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="включить-аппаратный-reset-у-emmc">Включить аппаратный reset у eMMC<a class="hash-link" aria-label="Прямая ссылка на Включить аппаратный reset у eMMC" title="Прямая ссылка на Включить аппаратный reset у eMMC" href="https://napiworld.ru/recipes/emmc-hardware-reset#%D0%B2%D0%BA%D0%BB%D1%8E%D1%87%D0%B8%D1%82%D1%8C-%D0%B0%D0%BF%D0%BF%D0%B0%D1%80%D0%B0%D1%82%D0%BD%D1%8B%D0%B9-reset-%D1%83-emmc">​</a></h3>
<p><strong>Операция необратимая:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo mmc hwreset enable /dev/mmcblk0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="проверить-результат">Проверить результат<a class="hash-link" aria-label="Прямая ссылка на Проверить результат" title="Прямая ссылка на Проверить результат" href="https://napiworld.ru/recipes/emmc-hardware-reset#%D0%BF%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D0%B8%D1%82%D1%8C-%D1%80%D0%B5%D0%B7%D1%83%D0%BB%D1%8C%D1%82%D0%B0%D1%82">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo mmc extcsd read /dev/mmcblk0 | grep -i RST_N_FUNCTION</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Должно поменяться на <code>RST_N_FUNCTION: 0x01</code></p>
<p>#emmc #hard #napi</p>]]></content>
        <author>
            <name>dmn</name>
            <uri>https://github.com/dmnovikov</uri>
        </author>
        <category label="emmc" term="emmc"/>
        <category label="hardware-reset" term="hardware-reset"/>
        <category label="mmc" term="mmc"/>
        <category label="napi-slot" term="napi-slot"/>
        <category label="maskrom" term="maskrom"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Компиляция ядра NapiLinux - быстрый метод]]></title>
        <id>https://napiworld.ru/recipes/napilinux-kernel-compile</id>
        <link href="https://napiworld.ru/recipes/napilinux-kernel-compile"/>
        <updated>2025-10-22T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Как скомпилировать только ядро NapiLinux]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="как-скомпилировать-только-ядро-napilinux">Как скомпилировать только ядро NapiLinux<a class="hash-link" aria-label="Прямая ссылка на Как скомпилировать только ядро NapiLinux" title="Прямая ссылка на Как скомпилировать только ядро NapiLinux" href="https://napiworld.ru/recipes/napilinux-kernel-compile#%D0%BA%D0%B0%D0%BA-%D1%81%D0%BA%D0%BE%D0%BC%D0%BF%D0%B8%D0%BB%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D1%82%D1%8C-%D1%82%D0%BE%D0%BB%D1%8C%D0%BA%D0%BE-%D1%8F%D0%B4%D1%80%D0%BE-napilinux">​</a></h2>
<p>Это "грязный" быстрый метод, который позволяет не компилировать всю систему, а быстро включить какие-то опции ядра и проверить новое ядро в системе.</p>
<p><strong>Правильный способ компиляции NapiLinux</strong> — через пакет Yocto.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-сделать-клон-ядра-с-нужной-ветки-branch">1. Сделать клон ядра с нужной ветки (branch)<a class="hash-link" aria-label="Прямая ссылка на 1. Сделать клон ядра с нужной ветки (branch)" title="Прямая ссылка на 1. Сделать клон ядра с нужной ветки (branch)" href="https://napiworld.ru/recipes/napilinux-kernel-compile#1-%D1%81%D0%B4%D0%B5%D0%BB%D0%B0%D1%82%D1%8C-%D0%BA%D0%BB%D0%BE%D0%BD-%D1%8F%D0%B4%D1%80%D0%B0-%D1%81-%D0%BD%D1%83%D0%B6%D0%BD%D0%BE%D0%B9-%D0%B2%D0%B5%D1%82%D0%BA%D0%B8-branch">​</a></h3>
<p>Бранч — это версия репозитория ядра. Для разных платформ она разная, и нужно выбрать ту, которая вас интересует:</p>
<ul>
<li><code>rk-6.1</code></li>
<li><code>orange-pi-6.6</code></li>
<li><code>rk35xx</code></li>
</ul>
<p>и т. п. (выбирайте на сайте GitLab)</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git clone https://gitlab.nnz-ipc.net/pub/napilinux/kernel.git --branch=rk-6.1 --depth=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd kernel/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-настроить-переменные-для-архитектуры-arm64">2. Настроить переменные для архитектуры (ARM64)<a class="hash-link" aria-label="Прямая ссылка на 2. Настроить переменные для архитектуры (ARM64)" title="Прямая ссылка на 2. Настроить переменные для архитектуры (ARM64)" href="https://napiworld.ru/recipes/napilinux-kernel-compile#2-%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B8%D1%82%D1%8C-%D0%BF%D0%B5%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%BD%D1%8B%D0%B5-%D0%B4%D0%BB%D1%8F-%D0%B0%D1%80%D1%85%D0%B8%D1%82%D0%B5%D0%BA%D1%82%D1%83%D1%80%D1%8B-arm64">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">export ARCH=arm64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export CROSS_COMPILE=aarch64-linux-gnu-</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-подготовить-конфиг">3. Подготовить конфиг<a class="hash-link" aria-label="Прямая ссылка на 3. Подготовить конфиг" title="Прямая ссылка на 3. Подготовить конфиг" href="https://napiworld.ru/recipes/napilinux-kernel-compile#3-%D0%BF%D0%BE%D0%B4%D0%B3%D0%BE%D1%82%D0%BE%D0%B2%D0%B8%D1%82%D1%8C-%D0%BA%D0%BE%D0%BD%D1%84%D0%B8%D0%B3">​</a></h3>
<ul>
<li>Конфиги лежат в папке <code>/arch/arm64/configs</code></li>
<li>В каждой ветке нужно выбрать свой конфиг:</li>
</ul>
<p><strong>Для Napi:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">make napi_defconfig</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Для CM4:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">make opi_cm4_defconfig</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-настройка-конфигурации">4. Настройка конфигурации<a class="hash-link" aria-label="Прямая ссылка на 4. Настройка конфигурации" title="Прямая ссылка на 4. Настройка конфигурации" href="https://napiworld.ru/recipes/napilinux-kernel-compile#4-%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0-%D0%BA%D0%BE%D0%BD%D1%84%D0%B8%D0%B3%D1%83%D1%80%D0%B0%D1%86%D0%B8%D0%B8">​</a></h3>
<p>После этого появится файл <code>.config</code>, в котором вы можете изменить опции ядра под себя.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-запускаем-компиляцию-ядра">5. Запускаем компиляцию ядра<a class="hash-link" aria-label="Прямая ссылка на 5. Запускаем компиляцию ядра" title="Прямая ссылка на 5. Запускаем компиляцию ядра" href="https://napiworld.ru/recipes/napilinux-kernel-compile#5-%D0%B7%D0%B0%D0%BF%D1%83%D1%81%D0%BA%D0%B0%D0%B5%D0%BC-%D0%BA%D0%BE%D0%BC%D0%BF%D0%B8%D0%BB%D1%8F%D1%86%D0%B8%D1%8E-%D1%8F%D0%B4%D1%80%D0%B0">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">make -j10</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="6-результаты-сборки">6. Результаты сборки<a class="hash-link" aria-label="Прямая ссылка на 6. Результаты сборки" title="Прямая ссылка на 6. Результаты сборки" href="https://napiworld.ru/recipes/napilinux-kernel-compile#6-%D1%80%D0%B5%D0%B7%D1%83%D0%BB%D1%8C%D1%82%D0%B0%D1%82%D1%8B-%D1%81%D0%B1%D0%BE%D1%80%D0%BA%D0%B8">​</a></h3>
<ul>
<li><strong>Имидж ядра</strong> — <code>arch/arm64/boot/Image</code></li>
<li><strong>Главная DTB</strong> (дерево устройств) — <code>arch/arm64/boot/&lt;файл&gt;.dtb</code></li>
<li><strong>Оверлеи</strong> — <code>arch/arm64/boot/dts/rockchip/</code></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="7-замена-ядра-в-системе">7. Замена ядра в системе<a class="hash-link" aria-label="Прямая ссылка на 7. Замена ядра в системе" title="Прямая ссылка на 7. Замена ядра в системе" href="https://napiworld.ru/recipes/napilinux-kernel-compile#7-%D0%B7%D0%B0%D0%BC%D0%B5%D0%BD%D0%B0-%D1%8F%D0%B4%D1%80%D0%B0-%D0%B2-%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D0%B5">​</a></h3>
<p>Теперь можно заменить файлы <code>Image</code> и <code>.dtb</code> в <code>/boot</code>, затем перезагрузить систему.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="8-важно-про-overlay-root">8. Важно про overlay root!<a class="hash-link" aria-label="Прямая ссылка на 8. Важно про overlay root!" title="Прямая ссылка на 8. Важно про overlay root!" href="https://napiworld.ru/recipes/napilinux-kernel-compile#8-%D0%B2%D0%B0%D0%B6%D0%BD%D0%BE-%D0%BF%D1%80%D0%BE-overlay-root">​</a></h3>
<p>NapiLinux использует root (<code>/</code>) как виртуальную партицию overlay, поэтому просто переписать ядро и другие файлы из системы не получится (на деле вы запишете их в overlay, и u-boot их не увидит).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="что-делать">Что делать?<a class="hash-link" aria-label="Прямая ссылка на Что делать?" title="Прямая ссылка на Что делать?" href="https://napiworld.ru/recipes/napilinux-kernel-compile#%D1%87%D1%82%D0%BE-%D0%B4%D0%B5%D0%BB%D0%B0%D1%82%D1%8C">​</a></h3>
<ul>
<li>
<p><strong>Если работаете на SD-карте</strong> — выньте SD, примонтируйте обе физические партиции и запишите новые файлы в их <code>/boot</code></p>
</li>
<li>
<p><strong>Если работаете с NAND/eMMC</strong> — загрузитесь с SD, примонтируйте обе партиции и запишите туда файлы вручную</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="просмотр-структуры-партиций">Просмотр структуры партиций<a class="hash-link" aria-label="Прямая ссылка на Просмотр структуры партиций" title="Прямая ссылка на Просмотр структуры партиций" href="https://napiworld.ru/recipes/napilinux-kernel-compile#%D0%BF%D1%80%D0%BE%D1%81%D0%BC%D0%BE%D1%82%D1%80-%D1%81%D1%82%D1%80%D1%83%D0%BA%D1%82%D1%83%D1%80%D1%8B-%D0%BF%D0%B0%D1%80%D1%82%D0%B8%D1%86%D0%B8%D0%B9">​</a></h3>
<p>Посмотреть структуру партиций можно командами:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">lsblk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lsblk -f</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>#napilinux #napikernel</p>]]></content>
        <author>
            <name>dmn</name>
            <uri>https://github.com/dmnovikov</uri>
        </author>
        <category label="napilinux" term="napilinux"/>
        <category label="kernel" term="kernel"/>
        <category label="compilation" term="compilation"/>
        <category label="cross-compile" term="cross-compile"/>
        <category label="overlay" term="overlay"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Просмотр опций компиляции ядра Linux]]></title>
        <id>https://napiworld.ru/recipes/linux-kernel-config</id>
        <link href="https://napiworld.ru/recipes/linux-kernel-config"/>
        <updated>2025-10-21T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Как посмотреть с какими опциями скомпилировано ядро Linux ?]]></summary>
        <content type="html"><![CDATA[<p>Как посмотреть с какими опциями скомпилировано ядро Linux ?</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">zcat /proc/config.gz</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Так же можно поставить фильтр - например, посмотрим все что касается последовательных портов</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">zcat /proc/config.gz | grep -E 'CONFIG_SERIAL_8250_NR_UARTS|CONFIG_SERIAL_8250|CONFIG_SERIAL_'</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>#linuxkernel #kernel #napikernel #uart</p>]]></content>
        <author>
            <name>dmn</name>
            <uri>https://github.com/dmnovikov</uri>
        </author>
        <category label="linux" term="linux"/>
        <category label="kernel" term="kernel"/>
        <category label="config" term="config"/>
        <category label="uart" term="uart"/>
        <category label="serial" term="serial"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Перенос blue-led на GPIO2B4 в Armbian]]></title>
        <id>https://napiworld.ru/recipes/blue-led-gpio2b4</id>
        <link href="https://napiworld.ru/recipes/blue-led-gpio2b4"/>
        <updated>2025-09-17T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Перевод blue-led на GPIO2B4]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="перевод-blue-led-на-gpio2b4">Перевод blue-led на GPIO2B4<a class="hash-link" aria-label="Прямая ссылка на Перевод blue-led на GPIO2B4" title="Прямая ссылка на Перевод blue-led на GPIO2B4" href="https://napiworld.ru/recipes/blue-led-gpio2b4#%D0%BF%D0%B5%D1%80%D0%B5%D0%B2%D0%BE%D0%B4-blue-led-%D0%BD%D0%B0-gpio2b4">​</a></h2>
<p>Перевод blue-led на <code>GPIO2B4</code> (Аrmbian).
(В предыдущем примере <code>GPIO3B3</code> попало на SPI1-CLK)</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="файл-конфигурации">Файл конфигурации<a class="hash-link" aria-label="Прямая ссылка на Файл конфигурации" title="Прямая ссылка на Файл конфигурации" href="https://napiworld.ru/recipes/blue-led-gpio2b4#%D1%84%D0%B0%D0%B9%D0%BB-%D0%BA%D0%BE%D0%BD%D1%84%D0%B8%D0%B3%D1%83%D1%80%D0%B0%D1%86%D0%B8%D0%B8">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@rockpi-s:~# cat blue-led-gpio2b4-1.dts</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-dts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-dts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/dts-v1/;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/plugin/;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fragment@0 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /* у вас узел именно под /leds */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        target-path = "/leds/blue-led";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        __overlay__ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            gpios = &lt;&amp;gpio2 12 0&gt;;          /* GPIO2_B4, ACTIVE_HIGH */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            linux,default-trigger = "heartbeat";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            default-state = "on";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            status = "okay";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>#napi #dts</p>]]></content>
        <author>
            <name>dmn</name>
            <uri>https://github.com/dmnovikov</uri>
        </author>
        <category label="gpio" term="gpio"/>
        <category label="led" term="led"/>
        <category label="overlay" term="overlay"/>
        <category label="armbian" term="armbian"/>
        <category label="dts" term="dts"/>
        <category label="spi" term="spi"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Восстановление повреждённых series в InfluxDB]]></title>
        <id>https://napiworld.ru/recipes/influxdb-series-repair</id>
        <link href="https://napiworld.ru/recipes/influxdb-series-repair"/>
        <updated>2025-09-17T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Как "починить" сломанные series в InfluxDB]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="как-починить-сломанные-series-в-influxdb">Как "починить" сломанные series в InfluxDB<a class="hash-link" aria-label="Прямая ссылка на Как &quot;починить&quot; сломанные series в InfluxDB" title="Прямая ссылка на Как &quot;починить&quot; сломанные series в InfluxDB" href="https://napiworld.ru/recipes/influxdb-series-repair#%D0%BA%D0%B0%D0%BA-%D0%BF%D0%BE%D1%87%D0%B8%D0%BD%D0%B8%D1%82%D1%8C-%D1%81%D0%BB%D0%BE%D0%BC%D0%B0%D0%BD%D0%BD%D1%8B%D0%B5-series-%D0%B2-influxdb">​</a></h2>
<p>Неожиданно при отладке датчиков influxdb перестал запускаться с такой ошибкой.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ошибка-запуска">Ошибка запуска<a class="hash-link" aria-label="Прямая ссылка на Ошибка запуска" title="Прямая ссылка на Ошибка запуска" href="https://napiworld.ru/recipes/influxdb-series-repair#%D0%BE%D1%88%D0%B8%D0%B1%D0%BA%D0%B0-%D0%B7%D0%B0%D0%BF%D1%83%D1%81%D0%BA%D0%B0">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-playfulokapi:~# /usr/lib/influxdb/scripts/influxd-systemd-start.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Command "print-config" is deprecated, use the influx-cli command server-config to display the configuration values from the running server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025-09-16T08:54:29.621708Z     info    Welcome to InfluxDB     {"log_id": "0z0RZky0000", "version": "v2.7.1", "commit": "407fa622e9", "build_date": "2023-04-28T13:24:42Z", "log_level": "info"}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025-09-16T08:54:29.677535Z     info    Resources opened        {"log_id": "0z0RZky0000", "service": "bolt", "path": "/root/.influxdbv2/influxd.bolt"}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025-09-16T08:54:29.680849Z     info    Resources opened        {"log_id": "0z0RZky0000", "service": "sqlite", "path": "/root/.influxdbv2/influxd.sqlite"}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025-09-16T08:54:29.754889Z     info    Checking InfluxDB metadata for prior version.   {"log_id": "0z0RZky0000", "bolt_path": "/root/.influxdbv2/influxd.bolt"}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025-09-16T08:54:29.756722Z     info    Using data dir  {"log_id": "0z0RZky0000", "service": "storage-engine", "service": "store", "path": "/root/.influxdbv2/engine/data"}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025-09-16T08:54:29.773043Z     info    Compaction settings     {"log_id": "0z0RZky0000", "service": "storage-engine", "service": "store", "max_concurrent_compactions": 2, "throughput_bytes_per_second": 50331648, "throughput_bytes_per_second_burst": 50331648}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025-09-16T08:54:29.774155Z     info    Open store (start)      {"log_id": "0z0RZky0000", "service": "storage-engine", "service": "store", "op_name": "tsdb_open", "op_event": "start"}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025-09-16T08:54:29.780689Z     error   Unable to open series file      {"log_id": "0z0RZky0000", "service": "storage-engine", "path": "/root/.influxdbv2/engine/data/50d1dfc5f00c762d/_series", "partition": 0, "error": "invalid series segment"}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025-09-16T08:54:29.781180Z     info    Open store (end)        {"log_id": "0z0RZky0000", "service": "storage-engine", "service": "store", "op_name": "tsdb_open", "op_event": "end", "op_elapsed": "7.046ms"}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025-09-16T08:54:29.781345Z     error   Failed to open engine   {"log_id": "0z0RZky0000", "error": "invalid series segment"}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Error: invalid series segment</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Как видно в логе - у нас сломался series. Очистка базы мне не помогла, поэтому чистил вручную.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="проверить-series">Проверить series<a class="hash-link" aria-label="Прямая ссылка на Проверить series" title="Прямая ссылка на Проверить series" href="https://napiworld.ru/recipes/influxdb-series-repair#%D0%BF%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D0%B8%D1%82%D1%8C-series">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-playfulokapi:~# influxd inspect   verify-seriesfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025-09-16T09:00:55.486187Z  error   Error opening segment   {"log_id": "0z0RwJBW000", "path": "/root/.influxdbv2/engine/data/50d1dfc5f00c762d/_series", "partition": "01", "segment": "0000", "error": "invalid series segment"}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025-09-16T09:00:55.497022Z  error   Error opening segment   {"log_id": "0z0RwJBW000", "path": "/root/.influxdbv2/engine/data/50d1dfc5f00c762d/_series", "partition": "00", "segment": "0000", "error": "invalid series segment"}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025-09-16T09:00:55.507980Z  error   Error opening segment   {"log_id": "0z0RwJBW000", "path": "/root/.influxdbv2/engine/data/50d1dfc5f00c762d/_series", "partition": "02", "segment": "0000", "error": "invalid series segment"}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Видим поломанный series. Удалим его и перестроим</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="удаление-повреждённых-series">Удаление повреждённых series<a class="hash-link" aria-label="Прямая ссылка на Удаление повреждённых series" title="Прямая ссылка на Удаление повреждённых series" href="https://napiworld.ru/recipes/influxdb-series-repair#%D1%83%D0%B4%D0%B0%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D0%BE%EF%BF%BD%D0%B2%D1%80%D0%B5%D0%B6%D0%B4%D1%91%D0%BD%D0%BD%D1%8B%D1%85-series">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mv /root/.influxdbv2/engine/data/50d1dfc5f00c762d/_series/ /root/.influxdbv2/engine/data/50d1dfc5f00c762d/_series.bad/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="перестроим-series">Перестроим series<a class="hash-link" aria-label="Прямая ссылка на Перестроим series" title="Прямая ссылка на Перестроим series" href="https://napiworld.ru/recipes/influxdb-series-repair#%D0%BF%D0%B5%D1%80%D0%B5%D1%81%D1%82%D1%80%D0%BE%D0%B8%D0%BC-series">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">influxd inspect build-tsi</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="результат">Результат<a class="hash-link" aria-label="Прямая ссылка на Результат" title="Прямая ссылка на Результат" href="https://napiworld.ru/recipes/influxdb-series-repair#%D1%80%D0%B5%D0%B7%D1%83%D0%BB%D1%8C%D1%82%D0%B0%D1%82">​</a></h3>
<p>После этого "шаманства" у меня influx запустился корректно.</p>
<p><strong>PS.</strong> Возможно это не самый удачный способ, но в записную книжку как срочный рецепт исправления я решил это записать.</p>
<p>#influxdb</p>]]></content>
        <author>
            <name>dmn</name>
            <uri>https://github.com/dmnovikov</uri>
        </author>
        <category label="influxdb" term="influxdb"/>
        <category label="repair" term="repair"/>
        <category label="debugging" term="debugging"/>
        <category label="series" term="series"/>
        <category label="tsi" term="tsi"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Перенос heartbeat диода на пользовательский GPIO через overlay]]></title>
        <id>https://napiworld.ru/recipes/gpio-heartbeat-overlay</id>
        <link href="https://napiworld.ru/recipes/gpio-heartbeat-overlay"/>
        <updated>2025-09-15T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Как перенести "софтовым" методом heartbit (диод активности) с встроенного GPIO на свободный]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="как-перенести-софтовым-методом-heartbit-диод-активности-с-встроенного-gpio-на-свободный">Как перенести "софтовым" методом heartbit (диод активности) с встроенного GPIO на свободный&nbsp;&nbsp;<a class="hash-link" aria-label="Прямая ссылка на Как перенести &quot;софтовым&quot; методом heartbit (диод активности) с встроенного GPIO на свободный&nbsp;&nbsp;" title="Прямая ссылка на Как перенести &quot;софтовым&quot; методом heartbit (диод активности) с встроенного GPIO на свободный&nbsp;&nbsp;" href="https://napiworld.ru/recipes/gpio-heartbeat-overlay#%D0%BA%D0%B0%D0%BA-%D0%BF%D0%B5%D1%80%D0%B5%D0%BD%D0%B5%D1%81%D1%82%D0%B8-%D1%81%D0%BE%D1%84%D1%82%D0%BE%D0%B2%D1%8B%D0%BC-%D0%BC%D0%B5%D1%82%D0%BE%D0%B4%D0%BE%D0%BC-heartbit-%D0%B4%D0%B8%D0%BE%D0%B4-%D0%B0%D0%BA%D1%82%D0%B8%D0%B2%D0%BD%D0%BE%D1%81%D1%82%D0%B8-%D1%81-%D0%B2%D1%81%D1%82%D1%80%D0%BE%D0%B5%D0%BD%D0%BD%D0%BE%D0%B3%D0%BE-gpio-%D0%BD%D0%B0-%D1%81%D0%B2%D0%BE%D0%B1%D0%BE%D0%B4%D0%BD%D1%8B%D0%B9">​</a></h2>
<p>По умолчанию диод на GPIO находится на&nbsp;
<code>GPIO0A5</code>, у нас в NAPI его нет на "гребёнке",&nbsp;
подтому мы его перекинем на <code>GPIO3B3</code>, который есть на "гребёнке" и ничем не занят.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="научимся-делать-user-overlay-к-ядру">Научимся делать user-overlay к ядру&nbsp;<a class="hash-link" aria-label="Прямая ссылка на Научимся делать user-overlay к ядру&nbsp;" title="Прямая ссылка на Научимся делать user-overlay к ядру&nbsp;" href="https://napiworld.ru/recipes/gpio-heartbeat-overlay#%D0%BD%D0%B0%D1%83%D1%87%D0%B8%D0%BC%D1%81%D1%8F-%D0%B4%D0%B5%D0%BB%D0%B0%D1%82%D1%8C-user-overlay-%D0%BA-%D1%8F%D0%B4%D1%80%D1%83">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="добавляем-оверлей-в-armbian">Добавляем оверлей в Armbian<a class="hash-link" aria-label="Прямая ссылка на Добавляем оверлей в Armbian" title="Прямая ссылка на Добавляем оверлей в Armbian" href="https://napiworld.ru/recipes/gpio-heartbeat-overlay#%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%BB%D1%8F%D0%B5%D0%BC-%D0%BE%D0%B2%D0%B5%D1%80%D0%BB%D0%B5%D0%B9-%D0%B2-armbian">​</a></h3>
<p>Сделать файл <code>blue-led-gpio3b3-2.dts</code> и добавить его как оверлей&nbsp;</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">armbian-add-overlay blue-led-gpio3b3-2.dts</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Команда сама скомпилирует dtbo, перенесем его в нужную папку и добавит запись в файл armbianEnv.txt.</p>
<p>Останется только перегрузится и убедиться, что диод "прикрепился" к нашему пину (визуально он станет сразу помигивать). Как проверить на каком GPIO оказался диод - в конце поста.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="файл-dts-для-armbian">Файл dts для Armbian<a class="hash-link" aria-label="Прямая ссылка на Файл dts для Armbian" title="Прямая ссылка на Файл dts для Armbian" href="https://napiworld.ru/recipes/gpio-heartbeat-overlay#%D1%84%D0%B0%D0%B9%D0%BB-dts-%D0%B4%D0%BB%D1%8F-armbian">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/dts-v1/;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/plugin/;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> fragment@0 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&nbsp;&nbsp;&nbsp;&nbsp; /* у вас узел именно под /leds */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&nbsp;&nbsp;&nbsp;&nbsp; target-path = "/leds/blue-led";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&nbsp;&nbsp;&nbsp;&nbsp; __overlay__ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; gpios = &lt;&amp;gpio3 11 0&gt;;&nbsp; &nbsp; &nbsp;  /* GPIO3_B3, ACTIVE_HIGH */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; linux,default-trigger = "heartbeat";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; default-state = "on";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; status = "okay";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* убрать pinctrl у конкретного LED, чтобы не валилось на -22 */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /delete-property/ pinctrl-names;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /delete-property/ pinctrl-0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&nbsp;&nbsp;&nbsp;&nbsp; };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="добавляем-оверлей-napilinux">Добавляем оверлей NapiLinux<a class="hash-link" aria-label="Прямая ссылка на Добавляем оверлей NapiLinux" title="Прямая ссылка на Добавляем оверлей NapiLinux" href="https://napiworld.ru/recipes/gpio-heartbeat-overlay#%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%BB%D1%8F%D0%B5%D0%BC-%D0%BE%D0%B2%D0%B5%D1%80%D0%BB%D0%B5%D0%B9-napilinux">​</a></h3>
<p>Необходимо скомпилировать из dts файла, dtbo файл через утилиту dtc на любом Linux-хосте.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dtc -@ -I dts -O dtb -o blue-led-gpio3b3.dtbo blue-led-gpio3b3.dts</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Делаем папку&nbsp;</p>
<p>mkdir /boot/overlay-user
Получившийся файл dtbo (blue-led-gpio3b3.dtbo) закинуть&nbsp; в&nbsp; /boot/overlay-user</p>
<p>Добавить строчку в файл /boot/uEnv.txt</p>
<p>user_overlays=blue-led-gpio3b3
Файл dts для NapiLinux</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/dts-v1/;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/plugin/;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> fragment@0 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&nbsp;&nbsp;&nbsp;&nbsp; /* у вас узел именно под /leds */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&nbsp;&nbsp;&nbsp;&nbsp; /* target-path = "/leds/blue-led"; */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&nbsp;&nbsp;&nbsp;&nbsp; target-path = "/gpio-leds/blue-led";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&nbsp;&nbsp;&nbsp;&nbsp; __overlay__ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; gpios = &lt;&amp;gpio3 11 0&gt;;&nbsp; &nbsp; &nbsp;  /* GPIO3_B3, ACTIVE_HIGH */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; linux,default-trigger = "heartbeat";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; default-state = "on";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; status = "okay";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&nbsp;&nbsp;&nbsp;&nbsp; };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="проверка-на-каком-gpio-blue-led">Проверка на каком gpio blue-led&nbsp;<a class="hash-link" aria-label="Прямая ссылка на Проверка на каком gpio blue-led&nbsp;" title="Прямая ссылка на Проверка на каком gpio blue-led&nbsp;" href="https://napiworld.ru/recipes/gpio-heartbeat-overlay#%D0%BF%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D0%BA%D0%B0-%D0%BD%D0%B0-%D0%BA%D0%B0%D0%BA%D0%BE%D0%BC-gpio-blue-led">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hexdump -v -e '1/4 "0x%08X "' -e '"\n"' /proc/device-tree/gpio-leds/blue-led/gpios</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Должно выдать: &lt;phandle gpio3, 0x0000000B, 0x00000000&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>#gpio #napi #dts</p>]]></content>
        <author>
            <name>dmn</name>
            <uri>https://github.com/dmnovikov</uri>
        </author>
        <category label="gpio" term="gpio"/>
        <category label="heartbeat" term="heartbeat"/>
        <category label="overlay" term="overlay"/>
        <category label="armbian" term="armbian"/>
        <category label="dts" term="dts"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Диагностика SD-NAND карт в Linux - получение регистров]]></title>
        <id>https://napiworld.ru/recipes/sd-nand-diagnostics</id>
        <link href="https://napiworld.ru/recipes/sd-nand-diagnostics"/>
        <updated>2025-08-31T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Пришлось глубоко копнуть в часть SD-NAND, так как некоторые карты Zetta не инициализировались в ядрах 6.х Linux.]]></summary>
        <content type="html"><![CDATA[<p>Пришлось глубоко копнуть в часть SD-NAND, так как некоторые карты Zetta не инициализировались в ядрах 6.х Linux.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="полезные-факты-и-приемы">Полезные факты и приемы<a class="hash-link" aria-label="Прямая ссылка на Полезные факты и приемы" title="Прямая ссылка на Полезные факты и приемы" href="https://napiworld.ru/recipes/sd-nand-diagnostics#%D0%BF%D0%BE%D0%BB%D0%B5%D0%B7%D0%BD%D1%8B%D0%B5-%D1%84%D0%B0%D0%BA%D1%82%D1%8B-%D0%B8-%D0%BF%D1%80%D0%B8%D0%B5%D0%BC%D1%8B">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="получаем-данные-регистров-sd-sd-nand-карт">Получаем данные регистров SD (SD-NAND) карт<a class="hash-link" aria-label="Прямая ссылка на Получаем данные регистров SD (SD-NAND) карт" title="Прямая ссылка на Получаем данные регистров SD (SD-NAND) карт" href="https://napiworld.ru/recipes/sd-nand-diagnostics#%D0%BF%D0%BE%D0%BB%D1%83%D1%87%D0%B0%D0%B5%D0%BC-%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D0%B5-%D1%80%D0%B5%D0%B3%D0%B8%D1%81%D1%82%D1%80%D0%BE%D0%B2-sd-sd-nand-%D0%BA%D0%B0%D1%80%D1%82">​</a></h3>
<p>Карта  1.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-rk3308b-s:~# cat /sys/bus/mmc/devices/mmc0\:1388/cid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ba2345534134474206071c06fe016945</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-rk3308b-s:~# cat /sys/bus/mmc/devices/mmc0\:1388/csd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">400e00325b5900001cdf7f800a4000d7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-rk3308b-s:~# cat /sys/bus/mmc/devices/mmc0\:1388/ocr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x00300000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-rk3308b-s:~# cat /sys/bus/mmc/devices/mmc0\:1388/rca</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x1388</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-rk3308b-s:~# cat /sys/bus/mmc/devices/mmc0\:1388/scr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0235000e00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-rk3308b-s:~#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Карта 2</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-nightstarfish:~# cat /sys/bus/mmc/devices/mmc0\:1388/cid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">e700115a6574746101b135ee4a719523</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-nightstarfish:~#  cat /sys/bus/mmc/devices/mmc0\:1388/csd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">400e00325b5900001d177f800a40008d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-nightstarfish:~# cat /sys/bus/mmc/devices/mmc0\:1388/ocr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x00300000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-nightstarfish:~# cat /sys/bus/mmc/devices/mmc0\:1388/rca</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x1388</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-nightstarfish:~# cat /sys/bus/mmc/devices/mmc0\:1388/scr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0205848f33333039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@napi-nightstarfish:~#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>В uboot</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">=&gt; mmc info</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Device: mmc@ff500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Manufacturer ID: 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OEM: 5344</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name: SA04G</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Bus Speed: 50000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Mode : SD High Speed (50MHz)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="расшифровка-scr-чатгпт">Расшифровка SCR (чатгпт)<a class="hash-link" aria-label="Прямая ссылка на Расшифровка SCR (чатгпт)" title="Прямая ссылка на Расшифровка SCR (чатгпт)" href="https://napiworld.ru/recipes/sd-nand-diagnostics#%D1%80%D0%B0%D1%81%D1%88%D0%B8%D1%84%D1%80%D0%BE%D0%B2%D0%BA%D0%B0-scr-%D1%87%D0%B0%D1%82%D0%B3%D0%BF%D1%82">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1) SCR contents (from Linux):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SCR = 02 05 84 8F 33 33 30 39</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Decoded:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SCR Structure = 0 (v1.0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SD Spec = 2.0 + Spec3 → SD 3.0 (UHS-I)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Bus widths = 1-bit and 4-bit supported</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Security = CPRM supported</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Byte 3 = 0x8F → according to the SD spec, bits indicate:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bit0 = CMD20 supported</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bit1 = CMD23 supported</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bit2 = CMD48 supported</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bit3 = CMD49 supported</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="расшифровка-cid-чатгпт">Расшифровка CID (чатгпт)<a class="hash-link" aria-label="Прямая ссылка на Расшифровка CID (чатгпт)" title="Прямая ссылка на Расшифровка CID (чатгпт)" href="https://napiworld.ru/recipes/sd-nand-diagnostics#%D1%80%D0%B0%D1%81%D1%88%D0%B8%D1%84%D1%80%D0%BE%D0%B2%D0%BA%D0%B0-cid-%D1%87%D0%B0%D1%82%D0%B3%D0%BF%D1%82">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">CID #1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ba2345534134474206071c06fe016945</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MID: 0xBA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OID: 0x23 0x45  → «#E» (непечатный/нестандартный OID, трактую как hex)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PNM: SA4GB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PRV: 0.6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PSN: 119277310 (0x071C06FE)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MDT: 2022-09  (разбор по формуле: ((cid[13]&amp;0x0F)&lt;&lt;8)|cid[14]) → год=2000+((mdt&gt;&gt;4)&amp;0xFF), месяц=mdt&amp;0xF)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">CID #2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">e700115a6574746101b135ee4a719523</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MID: 0xE7  (похоже на Zetta)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OID: 0x00 0x11  → непечатный (оставляем в hex)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PNM: Zetta</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PRV: 0.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PSN: 2973101642 (0xB135EE4A)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MDT: 2025-05</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="что-по-факту-отличается">Что по факту отличается<a class="hash-link" aria-label="Прямая ссылка на Что по факту отличается" title="Прямая ссылка на Что по факту отличается" href="https://napiworld.ru/recipes/sd-nand-diagnostics#%D1%87%D1%82%D0%BE-%D0%BF%D0%BE-%D1%84%D0%B0%D0%BA%D1%82%D1%83-%D0%BE%D1%82%D0%BB%D0%B8%D1%87%D0%B0%D0%B5%D1%82%D1%81%D1%8F">​</a></h3>
<p><strong>Производитель/бренд:</strong></p>
<p>— #1: MID=0xBA, имя продукта SA4GB (выглядит как «4GB» линейка).
— #2: MID=0xE7, имя продукта Zetta (бренд Zetta виден прямо в PNM).</p>
<p><strong>Версия продукта (PRV):</strong></p>
<p>— #1: 0.6 (более поздняя ревизия конкретной линейки),
— #2: 0.1 (самая ранняя ревизия).</p>
<p><strong>Серийный номер (PSN):</strong> разные (ожидаемо), у #2 — существенно большее значение.</p>
<p><strong>Дата производства (MDT):</strong>
— #1: 2022-09,
— #2: 2025-05 (свежее).</p>
<p><strong>OID:</strong> у обеих — непечатные/нестандартные коды (это нормально: поле OEM/Application ID не обязано быть ASCII).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="место-в-ядре-где-идёт-чтение-регистров-карты">Место в ядре где идёт чтение регистров карты<a class="hash-link" aria-label="Прямая ссылка на Место в ядре где идёт чтение регистров карты" title="Прямая ссылка на Место в ядре где идёт чтение регистров карты" href="https://napiworld.ru/recipes/sd-nand-diagnostics#%D0%BC%D0%B5%D1%81%D1%82%D0%BE-%D0%B2-%D1%8F%D0%B4%D1%80%D0%B5-%D0%B3%D0%B4%D0%B5-%D0%B8%D0%B4%D1%91%D1%82-%D1%87%D1%82%D0%B5%D0%BD%D0%B8%D0%B5-%D1%80%D0%B5%D0%B3%D0%B8%D1%81%D1%82%D1%80%D0%BE%D0%B2-%D0%BA%D0%B0%D1%80%D1%82%D1%8B">​</a></h3>
<p><a href="https://github.com/torvalds/linux/blob/07d9df80082b8d1f37e05658371b087cb6738770/drivers/mmc/core/sd.c#L1279" target="_blank" rel="noopener noreferrer">https://github.com/torvalds/linux/blob/07d9df80082b8d1f37e05658371b087cb6738770/drivers/mmc/core/sd.c#L1279</a></p>
<p>#sdnand #kernel #linuxkernel #sys #uboot</p>]]></content>
        <author>
            <name>dmn</name>
            <uri>https://github.com/dmnovikov</uri>
        </author>
        <category label="sd-nand" term="sd-nand"/>
        <category label="linux" term="linux"/>
        <category label="diagnostics" term="diagnostics"/>
        <category label="kernel" term="kernel"/>
        <category label="zetta" term="zetta"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Установка Zigbee2mqtt на NAPI-C (P)]]></title>
        <id>https://napiworld.ru/recipes/zigbee2mqtt-napi</id>
        <link href="https://napiworld.ru/recipes/zigbee2mqtt-napi"/>
        <updated>2025-08-29T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Устанавливаем на NAPI-C (P)  Zigbee2mqtt]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="устанавливаем-на-napi-c-p--zigbee2mqtt">Устанавливаем на NAPI-C (P)  Zigbee2mqtt<a class="hash-link" aria-label="Прямая ссылка на Устанавливаем на NAPI-C (P)  Zigbee2mqtt" title="Прямая ссылка на Устанавливаем на NAPI-C (P)  Zigbee2mqtt" href="https://napiworld.ru/recipes/zigbee2mqtt-napi#%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%B0%D0%B2%D0%BB%D0%B8%D0%B2%D0%B0%D0%B5%D0%BC-%D0%BD%D0%B0-napi-c-p--zigbee2mqtt">​</a></h2>
<ol>
<li>
<p>Устанавливаем Аrmbian</p>
</li>
<li>
<p>Ставим пакеты</p>
</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">apt-get install -y curl curl -fsSL https://deb.nodesource.com/setup_lts.x | sudo -E bash - apt-get install -y nodejs git make g++ gcc libsystemd-dev tmux apt install -y mosquitto mosquitto-clients corepack enable</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="3">
<li>Создадим каталог</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir /opt/zigbee2mqtt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="4">
<li>На случай если ставили не от рута нужно дать права на каталог</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo chown -R ${USER}: /opt/zigbee2mqtt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="5">
<li>Скачиваем гит в каталог</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git clone --depth 1 https://github.com/Koenkk/zigbee2mqtt.git /opt/zigbee2mqtt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="6">
<li>Переходим в каталог:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt/zigbee2mqtt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="7">
<li>Запустим tmux и продолжим сборку в нем:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">tmux</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="8">
<li>Собираем приложение</li>
</ol>
<p>Запустим сборку в один поток</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pnpm install --frozen-lockfile --child-concurrency=1 6.1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="9">
<li>После сборки выполняем запуск</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt/zigbee2mqtt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pnpm start</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="10">
<li>Делаем сервис</li>
</ol>
<p>Создаем файл</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">nano /etc/systemd/system/zigbee2mqtt.service</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>С таким содержимым</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[Unit]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Description=zigbee2mqtt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">After=network.target</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Service]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Environment=NODE_ENV=production</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Type=simple</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ExecStart=/usr/bin/pnpm start</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WorkingDirectory=/opt/zigbee2mqtt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">StandardOutput=inherit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">StandardError=inherit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Restart=always</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RestartSec=10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Install]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WantedBy=multi-user.target</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="11">
<li>Выполняем инициализацию и запуск сервиса</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl daemon-reload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl enable zigbee2mqtt.service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl start zigbee2mqtt.service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl status zigbee2mqtt.service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">journalctl -u zigbee2mqtt.service -f</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>#napi #zigbee $zigbee2mqtt</p>]]></content>
        <author>
            <name>dmn</name>
            <uri>https://github.com/dmnovikov</uri>
        </author>
        <category label="zigbee2mqtt" term="zigbee2mqtt"/>
        <category label="napi" term="napi"/>
        <category label="armbian" term="armbian"/>
        <category label="nodejs" term="nodejs"/>
        <category label="mosquitto" term="mosquitto"/>
        <category label="systemd" term="systemd"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Чтение и программирование EEPROM преобразователя FT232]]></title>
        <id>https://napiworld.ru/recipes/ft232-eeprom-reading</id>
        <link href="https://napiworld.ru/recipes/ft232-eeprom-reading"/>
        <updated>2025-08-15T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Читаем внутреннюю прошивку преобразователя rtu-usb ft232 под Linux (armbian na Napi-C)]]></summary>
        <content type="html"><![CDATA[<p>Читаем внутреннюю прошивку преобразователя rtu-usb ft232 под Linux (armbian na Napi-C)</p>
<p>Ставим софт</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt install libftdi1-2 libftdi1-dev ftdi-eeprom</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Читаем</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">touch c.txt #создаем пустой файл</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#vendor/product смотрим в lsusb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo 'vendor_id=0x0403</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">product_id=0x6001' &gt; c.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ftdi_eeprom --read-eeprom c.txt  --verbose</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Получаем результат</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">FTDI eeprom generator v0.17</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(c) Intra2net AG and the libftdi developers &lt;opensource@intra2net.com&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Unable to find FTDI device with description: i:0403:6001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Error code: -3 (device not found)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@rockpi-s:~# ftdi_eeprom --read-eeprom c.txt  --verbose</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FTDI eeprom generator v0.17</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(c) Intra2net AG and the libftdi developers &lt;opensource@intra2net.com&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Unable to find FTDI devices under given vendor/product id: 0x0/0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Error code: -3 (device not found)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Retrying with default FTDI pid=0x6001.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FTDI read eeprom: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EEPROM size: 128</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">VID:     0x0403</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PID:     0x6001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Release: 0x0000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Bus Powered:  90 mA USB Remote Wake Up</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Manufacturer: FTDI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Product:      FT232R USB UART</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Serial:       A10M5ZU3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Checksum      : 17cb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Internal EEPROM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Oscillator: Internal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Enable Remote Wake Up</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PNP: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Channel A has Mode UART VCP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C0 Function: TXLED</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C1 Function: RXLED</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C2 Function: TXDEN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C3 Function: PWREN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C4 Function: SLEEP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Warning: Not writing eeprom, you must supply a valid filename</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FTDI close: 0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Этой же программой можно писать
параметры в еепром ft232, создав конфигурационный файлик.</p>
<p>🙋‍♀️Зачем это надо ?</p>
<ul>
<li>Проверить жив ли ft232</li>
<li>Проверить назначение линий CBUS (C0-C4), которые могут быть переопределены.</li>
</ul>
<p>👍 Полезные факты</p>
<ul>
<li>
<p><code>lsusb -v</code> — должно быть состояние <code>bConfigurationValue = 1</code></p>
</li>
<li>
<p><code>PWREN</code> # после того как модуль инициализирован драйвером должен быть в НУЛЕ (<code>0</code>)</p>
</li>
<li>
<p><code>SLEEP</code> #у FTDI — это сигнал, который показывает, что чип перешёл в режим сна (USB suspend).</p>
</li>
</ul>
<p>Когда USB-шина в нормальном рабочем состоянии → <code>SLEEP# = 1</code> (логическая единица).</p>
<p>Когда хост перевёл устройство в режим suspend (спящий режим по USB, обычно при бездействии или энергосбережении) → <code>SLEEP# = 0</code>.</p>
<p>😂 Несколько подсказок от чатГПТ (я не проверял)</p>
<ol>
<li>Сохранить сырой еепром</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo ftdi_eeprom --read-eeprom текущий.conf --device ft232 --small-eeprom --eeprom-filename дамп.bin</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>Файл, если нужно прошить свои кастом параметры (<code>ftdi.conf</code>)</li>
</ol>
<div class="language-conf codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-conf codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">vendor_id=0x0403</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">product_id=0x6001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">manufacturer="MyCompany"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">product="My FT232R"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">serial="FT123456"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># CBUS configuration:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cbus0=1   # Можно оставить как есть или назначить PWREN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cbus1=1   # PWREN, к примеру</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cbus2=0   # TXDEN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cbus3=2   # RXLED (имитация RXDEN через LED#)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cbus4=4   # TXRXLED</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Как писать</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo ftdi_eeprom --flash-eeprom ftdi.conf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>#sys #ft232 #linux</p>]]></content>
        <author>
            <name>dmn</name>
            <uri>https://github.com/dmnovikov</uri>
        </author>
        <category label="ft232" term="ft232"/>
        <category label="eeprom" term="eeprom"/>
        <category label="usb" term="usb"/>
        <category label="uart" term="uart"/>
        <category label="linux" term="linux"/>
        <category label="cbus" term="cbus"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Конфигурация uEnv.txt для Сборщик компакт 0.3]]></title>
        <id>https://napiworld.ru/recipes/fcc03-uenv-config</id>
        <link href="https://napiworld.ru/recipes/fcc03-uenv-config"/>
        <updated>2025-08-13T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[uEnv.txt для Сборщик компакт 0.3 (с блоком питания 1,2А)]]></summary>
        <content type="html"><![CDATA[<p><code>uEnv.txt</code> для Сборщик компакт 0.3 (с блоком питания 1,2А)</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">verbosity=7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fdtfile=rk3308-napi-c.dtb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">console=ttyS0,115200n8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">overlays=rk3308-uart1 rk3308-uart3-m0 rk3308-i2c1-ds1338 rk3308-i2c3-m0 rk3308-usb20-host</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kernelimg=Image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">extraargs=</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>🔥Важно: RS485 у этой модели находится на <code>/dev/ttyS3</code></p>
<p>#fcc #fcc03 #fcc3308</p>]]></content>
        <author>
            <name>dmn</name>
            <uri>https://github.com/dmnovikov</uri>
        </author>
        <category label="fcc03" term="fcc03"/>
        <category label="uenv" term="uenv"/>
        <category label="rs485" term="rs485"/>
        <category label="rk3308" term="rk3308"/>
        <category label="overlay" term="overlay"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Конфигурация UART на модуле CM4 в Токосборщике]]></title>
        <id>https://napiworld.ru/recipes/cm4-uart-configuration</id>
        <link href="https://napiworld.ru/recipes/cm4-uart-configuration"/>
        <updated>2025-08-10T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[В Токосборщике на модуле CM4 UART-ы расположились следующим образом:]]></summary>
        <content type="html"><![CDATA[<p>В Токосборщике на модуле CM4 UART-ы расположились следующим образом:</p>
<p>✔️<code>UART3</code> - внешний датчик Modbus
✔️<code>UART9</code> - модуль расширений (Zigbee)
✔️<code>UART7</code> - встроенный датчик тока</p>
<p>Для корректной работе Debian, необходимо подключить оверлеи с uart7,9 в файле <code>/boot/orangepiEnv.txt</code></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@orangepicm4:~# cat /boot/orangepiEnv.txt </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">verbosity=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bootlogo=false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">extraargs=cma=128M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">overlay_prefix=rk356x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">overlays=uart7-m2 uart9-m2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rootdev=UUID=a0f8ca89-7eb7-4a1e-947a-2341637b4782</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rootfstype=ext4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">console=serial</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>#fcucm4 #orangecm4 #fcu</p>]]></content>
        <author>
            <name>dmn</name>
            <uri>https://github.com/dmnovikov</uri>
        </author>
        <category label="uart" term="uart"/>
        <category label="cm4" term="cm4"/>
        <category label="orangepi" term="orangepi"/>
        <category label="overlay" term="overlay"/>
        <category label="modbus" term="modbus"/>
        <category label="zigbee" term="zigbee"/>
    </entry>
</feed>