---
sidebar_position: 2
---

# F.A,Q. Часто задаваемые вопросы по NAPI

:fire: Мы начинаем формировать большой раздел вопрос-ответ для Napi. Раздел будет постоянно пополняться.:fire:

## Часть 1. Общие вопросы по ОС и загрузке.

### Q1. Какая прошивка грузится по умолчанию ? С SD или с внутреннего носителя (NAND) ?

A1. Если система видит загрузчик на SD-карте, то она пытается грузится с него. Если загрузчика на SD карте нет (или карта не вставлена), система грузится с внутреннего носителя.


### Q2. Какие варианты ОС ?

А2. Есть три варианта ОС Linux для Napi

**1. Скачать образ ARMBian для Napi.**

**Плюсы:**
>Возможность скачать и установить софт из репозиториев Armbian (debian)

**Минусы:**

>Это дистрибутив общего назначения, в нем специального функционала для embedded устройств.

**Вывод**:

>Хорошо подходит для разработки и отладки а также для прототипирования

**2. Использовать наш дистрибутив NapiLinux**

**Плюсы:**

>В сборке есть набор embedded-ориентированных функций: возможность апгрейда, быстрых бекапов и восстановлений, скидывания в дефолт.

>В варианте FrontControl в дистрибутив уже интегрирован и пред-настроен софт для работы с данными: Telegraf, InfluxDB, mbusd, snmpd, mosquitto, python (pymodbus), gpiod2, mbpoll.

>В варианте FrontControl имеется Веб-интерфейс NapiConfig, позволяющий настроить сеть, службы через Веб-инерфейс.

>В варианте FrontControl в Веб-интерфейсе NapiConfig есть возможность настраивать шаблоны датчиков для Telegraf и получать данные с датчиков.

>В варианте FrontControl в Веб-интерфейсе NapiCon-TCP, Snmp V2-V3.

**Минусы:**

 >Нет пакетного менеджера, ограниченный набор программного обеспечения

**3. Скомпилировать свою сборку NapiLnux**

**Плюсы:**

>С помощью этого метода можно добавить необходимый софт в прошивку и иметь все плюсы прошивки для Embedded + необходимый софт.

**Минусы**

>Необходимо освоить тулкит yocto, научиться писать рецепты, компилировать прошивку (можно обратиться к нам для создания своей прошивки).

### Q3. Сколько свободного места на устройстве

A3. Рассмотрим в случае Armbian и NapiLnux

В Armbian одна партиция, которая "отдана" под корневую файловую систему

Если у нас NAND 4Гб, то при установленном Armbian структура fs выглядит так:

```bash
root@napi-armbian:~# df -h
Filesystem      Size  Used Avail Use% Mounted on
udev            163M     0  163M   0% /dev
tmpfs            48M  1.8M   46M   4% /run
/dev/mmcblk0p1  3.4G  2.3G  1.1G  69% /
tmpfs           237M     0  237M   0% /dev/shm
tmpfs           5.0M     0  5.0M   0% /run/lock
tmpfs           237M     0  237M   0% /tmp
/dev/zram1       47M   22M   22M  51% /var/log
tmpfs            48M     0   48M   0% /run/user/0

```

Видно, что в системе для корневой файловой системы выделено 3.4Гб и 1.1Гб свободен.

 NapiLinux система разбита на 3 раздела.

 - Два раздела с системой дублируют друг друга и "подменяют" друг друга в случае неудачного обновления, сбоя.

 - Третий раздел с всеми пользовательскими данными и конфигами накладывается в режиме overlay на текущий рабочий раздел с системой.

```
root@napi-rk3308b-s:~# df -h
Filesystem      Size  Used Avail Use% Mounted on
devtmpfs        196M     0  196M   0% /dev
/dev/root       1.4G  899M  428M  68% /mount/rfs/ro
/dev/mmcblk0p3  649M   25M  589M   4% /mount/rfs/rw
overlay         649M   25M  589M   4% /
tmpfs           207M     0  207M   0% /dev/shm
tmpfs            83M  5.4M   78M   7% /run
tmpfs           4.0M     0  4.0M   0% /sys/fs/cgroup
tmpfs           207M   20K  207M   1% /var/volatile
tmpfs            42M     0   42M   0% /run/user/0
root@napi-rk3308b-s:~#

```

Корневой файловой системе (/dev/root) отдано 1.4Гб (система дублируется на два раздела, которые занимают 2.8Гб из 4Гб).

Пользовательским данным (overlay) отводится 650Мб. Как видно из листинга, в нашем случае из 650Мб занято 25Мб.

### Q4. Как узнать в какой я системе ?

A3. Если Вы загрузили NapiLinux у вас при входе в систему выскочит симпатичное лого, также информация о сборке будет доступна в файле

`/etc/os-release`

```

   _   _       ____  _
  | \ | | __ _|  _ \(_)
  |  \| |/ _` | |_) | |
  | |\  | (_| |  __/| |
  |_| \_|\__,_|_|   |_|

    Linux for Embedded


  NapiConfig (web) on port 443, Updates on port 8082. Enjoy!
  website: https://napiworld.ru

root@napi-rk3308b-s:~# more /etc/os-release
ID=napi-linux
NAME="Napi Linux (Yocto build)"
VERSION="0.1.19.1-dev-fe684305 (kirkstone)"
VERSION_ID=0.1.19.1-dev-fe684305
PRETTY_NAME="Napi Linux (Yocto build) 0.1.19.1-dev-fe684305 (kirkstone)"
DISTRO_CODENAME="kirkstone"
root@napi-rk3308b-s:~#

```

При загрузке, логотип и приглашение будет выглядеть примерно так

```
root@192.168.110.17's password:
 ____            _          _   ____
|  _ \ ___   ___| | ___ __ (_) / ___|
| |_) / _ \ / __| |/ / '_ \| | \___ \
|  _ < (_) | (__|   <| |_) | |  ___) |
|_| \_\___/ \___|_|\_\ .__/|_| |____/
                     |_|
Welcome to Armbian 24.5.1 Bookworm with Linux 6.6.32-current-rockchip64

System load:   2%           	Up time:       4 days 15:23
Memory usage:  22% of 472M   	IP:	       192.168.110.17
Usage of /:    69% of 3.4G
RX today:      1.8 MiB

Tip of the day: What's new in Armbian build framework https://github.com/armbian/build/releases/tag/v24.11.1

[ 0 security updates available, 95 updates total: apt upgrade ]
Last check: 2025-01-27 00:00

[ General system configuration (beta): armbian-config ]

Last login: Wed Jan 22 14:45:33 2025 from 192.168.110.76
```

### Q5. Как понять, что система "жива", как достучаться ?

На чипе имеется светодиод "жизни", если Linux загружен и работает, то
светодиод помигивает (в наших устройствах он синий).

Проще всего достучаться через ssh (сеть тоже должна помигивать), для этого надо узнать IP адрес. Если с сетью ничего не понятно, то необходимо поключить отладочную консоль.

>[Статья](/software/notes/findip/) как найти Napi по IP \
>[Статья](/software/console/) как получить доступ через консоль

Если у Вас NapiLinux,то можно сразу идти на Веб-интерфейс по адресу

>https://\<IP устройства\>


### Q6. Как прошить Napi и попробовать разные ОС

Чтобы попробовать Armbian или NapiLinux достаточно c помощью программы [Balena Etcher](https://www.balena.io/etcher) перенести прошивку ОС из файла на SD.

>Обратите внимание, что нельзя просто скопировать файл с прошивкой на SD, нужно именно с помощью специального ПО побайтно "прошить" SD-шку из файла.

После этого
 - отключите питание
 - вставьте SD в слот
 - проверьте что крышка защелкнута
 - подайте питание

 Диод жизни должен замигать, система должна ть доступна по ssh !

 Как прошить систему в Nand\Emmc написано в [статьях](/software/category/прошивка-бекап) на нашем сайте.

 В статьях описано несколько способов:

 - С помощью USB-кабеля и утилиты rktools
 - С помощью USB-флешки
